import{s as ae,f as wn,i as Jn,a as dr,u as fr,g as mr,b as gr,m as pr,n as q,o as xe,r as Ee,c as _e,e as We,l as Ts,C as $e,t as _r}from"../chunks/scheduler.Cvj_X37g.js";import{S as ie,i as oe,m as nt,n as ln,o as st,p as Y,q as $,r as rt,e as A,s as O,c as E,a as I,d as k,f as M,k as V,l as S,g as j,h as g,E as B,t as z,b as G,C as Fe,F as It,j as Ae,x as lt,v as ct,G as Fs,H as Os,D as we,u as Ue,w as Tt,y as zn}from"../chunks/index.CskyfdKe.js";import{I as wr,g as br,a as yr,e as ee}from"../chunks/Icon.BkPAy3w7.js";import{w as ut}from"../chunks/index.Bc1E7i12.js";function vr(r){let e;const t=r[2].default,n=dr(t,r,r[3],null);return{c(){n&&n.c()},l(s){n&&n.l(s)},m(s,a){n&&n.m(s,a),e=!0},p(s,a){n&&n.p&&(!e||a&8)&&fr(n,t,s,s[3],e?gr(t,s[3],a,null):mr(s[3]),null)},i(s){e||(Y(n,s),e=!0)},o(s){$(n,s),e=!1},d(s){n&&n.d(s)}}}function Sr(r){let e,t;const n=[{name:"send-horizontal"},r[1],{iconNode:r[0]}];let s={$$slots:{default:[vr]},$$scope:{ctx:r}};for(let a=0;a<n.length;a+=1)s=wn(s,n[a]);return e=new wr({props:s}),{c(){nt(e.$$.fragment)},l(a){ln(e.$$.fragment,a)},m(a,i){st(e,a,i),t=!0},p(a,[i]){const o=i&3?br(n,[n[0],i&2&&yr(a[1]),i&1&&{iconNode:a[0]}]):{};i&8&&(o.$$scope={dirty:i,ctx:a}),e.$set(o)},i(a){t||(Y(e.$$.fragment,a),t=!0)},o(a){$(e.$$.fragment,a),t=!1},d(a){rt(e,a)}}}function xr(r,e,t){let{$$slots:n={},$$scope:s}=e;const a=[["path",{d:"m3 3 3 9-3 9 19-9Z"}],["path",{d:"M6 12h16"}]];return r.$$set=i=>{t(1,e=wn(wn({},e),Jn(i))),"$$scope"in i&&t(3,s=i.$$scope)},e=Jn(e),[a,e,n,s]}class Cr extends ie{constructor(e){super(),oe(this,e,xr,Sr,ae,{})}}function Ft(r,{delay:e=0,duration:t=400,easing:n=pr}={}){const s=+getComputedStyle(r).opacity;return{delay:e,duration:t,easing:n,css:a=>`opacity: ${a*s}`}}const kr=()=>localStorage.getItem("openAIKey")||"",Ar=ut(kr()),J=ut({}),Pe=ut([]),bn=ut(!1),Se=ut(!1);J.subscribe(r=>{console.log("userData",r)});function Er(r){let e,t,n,s,a,i,o,c="Tell us about yourself",l,h,f=`We'll get to know you and we can personalize a plan for your finances, family, and goals.
					This should take only 5-10 minutes.`,y,d,p="Take the Quiz",b,P,R=`<p>Investment advisory services provided through Fidelity Personal and Workplace Advisors LLC,
				a registered investment adviser, for a fee. Brokerage services provided through Fidelity
				Brokerage Services LLC, Member NYSE, SIPC. Both are Fidelity Investments companies. The
				images, graphs, tools, and videos are for illustrative purposes only.</p> <p>Fidelity Brokerage Services LLC, Member NYSE, SIPC, 900 Salem Street, Smithfield, RI</p> <p>02917 782377.109.0</p>`,u,w;return{c(){e=A("div"),t=A("div"),n=O(),s=A("div"),a=A("div"),i=A("div"),o=A("h1"),o.textContent=c,l=O(),h=A("p"),h.textContent=f,y=O(),d=A("button"),d.textContent=p,b=O(),P=A("div"),P.innerHTML=R,this.h()},l(m){e=E(m,"DIV",{class:!0});var _=I(e);t=E(_,"DIV",{class:!0}),I(t).forEach(k),n=M(_),s=E(_,"DIV",{class:!0});var v=I(s);a=E(v,"DIV",{class:!0});var x=I(a);i=E(x,"DIV",{class:!0});var C=I(i);o=E(C,"H1",{class:!0,"data-svelte-h":!0}),V(o)!=="svelte-1lc6bui"&&(o.textContent=c),l=M(C),h=E(C,"P",{class:!0,"data-svelte-h":!0}),V(h)!=="svelte-ssohfm"&&(h.textContent=f),y=M(C),d=E(C,"BUTTON",{class:!0,"data-svelte-h":!0}),V(d)!=="svelte-1tinlz"&&(d.textContent=p),C.forEach(k),x.forEach(k),b=M(v),P=E(v,"DIV",{class:!0,"data-svelte-h":!0}),V(P)!=="svelte-3n41qz"&&(P.innerHTML=R),v.forEach(k),_.forEach(k),this.h()},h(){S(t,"class","min-h-[calc(100vh-112px)] picture svelte-xyzp20"),S(o,"class","font-light"),S(h,"class","my-4 font-light text-sm text-fidelity-neutral-600"),S(d,"class","bg-fidelity-green-600 text-white svelte-xyzp20"),S(i,"class","w-80"),S(a,"class","flex h-[calc(100%-150px)] items-center justify-center"),S(P,"class","h-[150px] text-[9px] p-8 space-y-3 text-fidelity-neutral-500"),S(s,"class","flex flex-col"),S(e,"class","grid grid-cols-2 w-full")},m(m,_){j(m,e,_),g(e,t),g(e,n),g(e,s),g(s,a),g(a,i),g(i,o),g(i,l),g(i,h),g(i,y),g(i,d),g(s,b),g(s,P),u||(w=B(d,"click",r[3]),u=!0)},p:q,i:q,o:q,d(m){m&&k(e),u=!1,w()}}}function Rr(r,e,t){let{back:n}=e,{next:s}=e,{changeStep:a=o=>{}}=e;xe(()=>{console.log(n),Se.set(!1)});const i=()=>a(s);return r.$$set=o=>{"back"in o&&t(2,n=o.back),"next"in o&&t(0,s=o.next),"changeStep"in o&&t(1,a=o.changeStep)},[s,a,n,i]}class Pr extends ie{constructor(e){super(),oe(this,e,Rr,Er,ae,{back:2,next:0,changeStep:1})}}function Gn(r,e,t){const n=r.slice();return n[10]=e[t],n[12]=t,n}function Kn(r){let e,t=r[10].label+"",n,s,a,i;function o(){return r[7](r[12])}return{c(){e=A("button"),n=z(t),s=O(),this.h()},l(c){e=E(c,"BUTTON",{class:!0});var l=I(e);n=G(l,t),s=M(l),l.forEach(k),this.h()},h(){S(e,"class","grid svelte-q9pajy"),It(e,"selected",r[10].status)},m(c,l){j(c,e,l),g(e,n),g(e,s),a||(i=B(e,"click",o),a=!0)},p(c,l){r=c,l&8&&t!==(t=r[10].label+"")&&Ae(n,t),l&8&&It(e,"selected",r[10].status)},d(c){c&&k(e),a=!1,i()}}}function Ir(r){let e,t,n,s,a,i,o,c="How would you like to get started today?",l,h,f="Please select anything you would like to help you with:",y,d,p,b,P,R="Back",u,w,m,_,v,x=ee(r[3]),C=[];for(let T=0;T<x.length;T+=1)C[T]=Kn(Gn(r,x,T));return{c(){e=A("div"),t=A("div"),n=O(),s=A("div"),a=A("div"),i=A("div"),o=A("h1"),o.textContent=c,l=O(),h=A("p"),h.textContent=f,y=O(),d=A("div");for(let T=0;T<C.length;T+=1)C[T].c();p=O(),b=A("div"),P=A("button"),P.textContent=R,u=O(),w=A("button"),m=z("Next"),this.h()},l(T){e=E(T,"DIV",{class:!0});var W=I(e);t=E(W,"DIV",{class:!0}),I(t).forEach(k),n=M(W),s=E(W,"DIV",{class:!0});var L=I(s);a=E(L,"DIV",{class:!0});var be=I(a);i=E(be,"DIV",{class:!0});var Ce=I(i);o=E(Ce,"H1",{class:!0,"data-svelte-h":!0}),V(o)!=="svelte-1c1n5sv"&&(o.textContent=c),l=M(Ce),h=E(Ce,"P",{class:!0,"data-svelte-h":!0}),V(h)!=="svelte-9dtfsf"&&(h.textContent=f),y=M(Ce),d=E(Ce,"DIV",{class:!0});var Hn=I(d);for(let dn=0;dn<C.length;dn+=1)C[dn].l(Hn);Hn.forEach(k),p=M(Ce),b=E(Ce,"DIV",{class:!0});var dt=I(b);P=E(dt,"BUTTON",{class:!0,"data-svelte-h":!0}),V(P)!=="svelte-1admezx"&&(P.textContent=R),u=M(dt),w=E(dt,"BUTTON",{class:!0});var Xn=I(w);m=G(Xn,"Next"),Xn.forEach(k),dt.forEach(k),Ce.forEach(k),be.forEach(k),L.forEach(k),W.forEach(k),this.h()},h(){S(t,"class","min-h-[calc(100vh-112px)] picture svelte-q9pajy"),S(o,"class","font-light text-center"),S(h,"class","my-4 font-light text-sm text-center text-fidelity-neutral-600"),S(d,"class","flex justify-center items-center flex-wrap gap-2"),S(P,"class","back"),S(w,"class","next"),w.disabled=r[4],S(b,"class","grid grid-cols-2 w-3/4 mx-auto pt-8 gap-4"),S(i,"class","w-[80%] -mt-24"),S(a,"class","flex h-full items-center justify-center"),S(s,"class","flex flex-col"),S(e,"class","grid grid-cols-2 w-full")},m(T,W){j(T,e,W),g(e,t),g(e,n),g(e,s),g(s,a),g(a,i),g(i,o),g(i,l),g(i,h),g(i,y),g(i,d);for(let L=0;L<C.length;L+=1)C[L]&&C[L].m(d,null);g(i,p),g(i,b),g(b,P),g(b,u),g(b,w),g(w,m),_||(v=[B(P,"click",r[8]),B(w,"click",r[9])],_=!0)},p(T,[W]){if(W&40){x=ee(T[3]);let L;for(L=0;L<x.length;L+=1){const be=Gn(T,x,L);C[L]?C[L].p(be,W):(C[L]=Kn(be),C[L].c(),C[L].m(d,null))}for(;L<C.length;L+=1)C[L].d(1);C.length=x.length}W&16&&(w.disabled=T[4])},i:q,o:q,d(T){T&&k(e),Fe(C,T),_=!1,Ee(v)}}}function Tr(r,e,t){let n,s;_e(r,J,d=>t(6,s=d)),xe(()=>{Se.set(!1)});let{back:a}=e,{next:i}=e,{changeStep:o=d=>{}}=e,c=[{label:"Save for Retirement",status:0},{label:"Build Wealth",status:0},{label:"Save for College",status:0},{label:"Give to Charity",status:0},{label:"Create a Budget",status:0},{label:"Save for a Rainy Day",status:0},{label:"Buy a Home",status:0},{label:"Pay down Debt",status:0}].map(d=>({label:d.label,status:s.goals&&s.goals.includes(d.label)?1:0}));const l=d=>{t(3,c=c.map((p,b)=>d===b?{...p,status:p.status?0:1}:p)),J.update(p=>(p.goals=c.filter(b=>b.status).map(b=>b.label),p))},h=d=>l(d),f=()=>o(a),y=()=>o(i);return r.$$set=d=>{"back"in d&&t(0,a=d.back),"next"in d&&t(1,i=d.next),"changeStep"in d&&t(2,o=d.changeStep)},r.$$.update=()=>{r.$$.dirty&64&&t(4,n=!s.goals||s.goals.length===0)},[a,i,o,c,n,l,s,h,f,y]}class Fr extends ie{constructor(e){super(),oe(this,e,Tr,Ir,ae,{back:0,next:1,changeStep:2})}}function Or(r){let e;return{c(){e=A("div")},l(t){e=E(t,"DIV",{}),I(e).forEach(k)},m(t,n){j(t,e,n)},p:q,i:q,o:q,d(t){t&&k(e)}}}function Mr(r){var h;let e,t,n,s=(((h=r[2].name)==null?void 0:h.split(" ")[0])||"")+"",a,i,o,c,l;return{c(){e=A("div"),t=A("h1"),n=z("Nice to meet you "),a=z(s),i=z("!"),this.h()},l(f){e=E(f,"DIV",{});var y=I(e);t=E(y,"H1",{class:!0});var d=I(t);n=G(d,"Nice to meet you "),a=G(d,s),i=G(d,"!"),d.forEach(k),y.forEach(k),this.h()},h(){S(t,"class","my-20 text-center text-fidelity-neutral-600 font-light")},m(f,y){j(f,e,y),g(e,t),g(t,n),g(t,a),g(t,i),l=!0},p(f,y){var d;(!l||y&4)&&s!==(s=(((d=f[2].name)==null?void 0:d.split(" ")[0])||"")+"")&&Ae(a,s)},i(f){l||(f&&Ts(()=>{l&&(c&&c.end(1),o=Fs(e,Ft,{duration:1e3}),o.start())}),l=!0)},o(f){o&&o.invalidate(),f&&(c=Os(e,Ft,{duration:500})),l=!1},d(f){f&&k(e),f&&c&&c.end()}}}function Dr(r){let e,t,n="What's your name",s,a,i="We'll use this to personalize your experience",o,c,l,h,f,y="Back",d,p,b,P,R;return{c(){e=A("div"),t=A("h1"),t.textContent=n,s=O(),a=A("p"),a.textContent=i,o=O(),c=A("textarea"),l=O(),h=A("div"),f=A("button"),f.textContent=y,d=O(),p=A("button"),b=z("Next"),this.h()},l(u){e=E(u,"DIV",{class:!0});var w=I(e);t=E(w,"H1",{class:!0,"data-svelte-h":!0}),V(t)!=="svelte-1wflpqz"&&(t.textContent=n),s=M(w),a=E(w,"P",{class:!0,"data-svelte-h":!0}),V(a)!=="svelte-10g4aiz"&&(a.textContent=i),o=M(w),c=E(w,"TEXTAREA",{class:!0,rows:!0}),I(c).forEach(k),l=M(w),h=E(w,"DIV",{class:!0});var m=I(h);f=E(m,"BUTTON",{class:!0,"data-svelte-h":!0}),V(f)!=="svelte-1admezx"&&(f.textContent=y),d=M(m),p=E(m,"BUTTON",{class:!0});var _=I(p);b=G(_,"Next"),_.forEach(k),m.forEach(k),w.forEach(k),this.h()},h(){S(t,"class","font-light"),S(a,"class","text-fidelity-neutral-500 my-3"),S(c,"class","single"),S(c,"rows","1"),S(f,"class","back"),S(p,"class","next"),p.disabled=r[5],S(h,"class","grid grid-cols-2 w-3/4 mx-auto pt-8 gap-4"),S(e,"class","w-96 h-1/2 mx-auto text-center")},m(u,w){j(u,e,w),g(e,t),g(e,s),g(e,a),g(e,o),g(e,c),r[9](c),we(c,r[2].name),g(e,l),g(e,h),g(h,f),g(h,d),g(h,p),g(p,b),P||(R=[B(c,"input",r[10]),B(c,"keydown",r[11]),B(f,"click",r[12]),B(p,"click",r[7])],P=!0)},p(u,w){w&4&&we(c,u[2].name),w&32&&(p.disabled=u[5])},i:q,o:q,d(u){u&&k(e),r[9](null),P=!1,Ee(R)}}}function Nr(r){let e,t,n;const s=[Dr,Mr,Or],a=[];function i(o,c){return o[4]==="form"?0:o[4]==="welcome"?1:2}return t=i(r),n=a[t]=s[t](r),{c(){e=A("div"),n.c(),this.h()},l(o){e=E(o,"DIV",{class:!0});var c=I(e);n.l(c),c.forEach(k),this.h()},h(){S(e,"class","h-[calc(100vh-112px)] pt-[10vh]")},m(o,c){j(o,e,c),a[t].m(e,null)},p(o,[c]){let l=t;t=i(o),t===l?a[t].p(o,c):(lt(),$(a[l],1,1,()=>{a[l]=null}),ct(),n=a[t],n?n.p(o,c):(n=a[t]=s[t](o),n.c()),Y(n,1),n.m(e,null))},i(o){Y(n)},o(o){$(n)},d(o){o&&k(e),a[t].d()}}}function Br(r,e,t){let n,s;_e(r,J,R=>t(2,s=R));let{back:a}=e,{next:i}=e,{changeStep:o=R=>{}}=e,c,l=!0,h="form";xe(()=>{Se.set(!0),s.name&&(l=!1),c==null||c.focus(),window.scrollTo(0,0)});const f=R=>{R.key==="Enter"&&(R.preventDefault(),y())},y=()=>{l?(Se.set(!1),t(4,h="welcome"),setTimeout(()=>{t(4,h="")},2250),setTimeout(()=>{o(i)},2500)):o(i)};function d(R){We[R?"unshift":"push"](()=>{c=R,t(3,c)})}function p(){s.name=this.value,J.set(s)}const b=R=>f(R),P=()=>o(a);return r.$$set=R=>{"back"in R&&t(0,a=R.back),"next"in R&&t(8,i=R.next),"changeStep"in R&&t(1,o=R.changeStep)},r.$$.update=()=>{r.$$.dirty&4&&t(5,n=s.name?s.name.length<=4:!0)},[a,o,s,c,h,n,f,y,i,d,p,b,P]}class jr extends ie{constructor(e){super(),oe(this,e,Br,Nr,ae,{back:0,next:8,changeStep:1})}}const Oe="4.45.0";let Yn=!1,et,Ms,Ds,yn,Ns,Bs,js,Ls,Vs;function Lr(r,e={auto:!1}){if(Yn)throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);if(et)throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${et}'\``);Yn=e.auto,et=r.kind,Ms=r.fetch,Ds=r.FormData,yn=r.File,Ns=r.ReadableStream,Bs=r.getMultipartRequestOptions,js=r.getDefaultAgent,Ls=r.fileFromPath,Vs=r.isFsReadStream}class Vr{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Wr({manuallyImported:r}={}){const e=r?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,s,a;try{t=fetch,n=Request,s=Response,a=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:s,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(i,o)=>({...o,body:new Vr(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}et||Lr(Wr(),{auto:!0});class N extends Error{}class Q extends N{constructor(e,t,n,s){super(`${Q.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"];const a=t;this.error=a,this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,n){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e)return new cn({cause:Sn(t)});const a=t==null?void 0:t.error;return e===400?new Ws(e,a,n,s):e===401?new Us(e,a,n,s):e===403?new qs(e,a,n,s):e===404?new Hs(e,a,n,s):e===409?new Xs(e,a,n,s):e===422?new Js(e,a,n,s):e===429?new zs(e,a,n,s):e>=500?new Gs(e,a,n,s):new Q(e,a,n,s)}}class se extends Q{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class cn extends Q{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class Tn extends cn{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Ws extends Q{constructor(){super(...arguments),this.status=400}}class Us extends Q{constructor(){super(...arguments),this.status=401}}class qs extends Q{constructor(){super(...arguments),this.status=403}}class Hs extends Q{constructor(){super(...arguments),this.status=404}}class Xs extends Q{constructor(){super(...arguments),this.status=409}}class Js extends Q{constructor(){super(...arguments),this.status=422}}class zs extends Q{constructor(){super(...arguments),this.status=429}}class Gs extends Q{}class pe{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const i of Ur(e,t))if(!a){if(i.data.startsWith("[DONE]")){a=!0;continue}if(i.event===null){let o;try{o=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(o&&o.error)throw new Q(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new Q(void 0,o.error,o.message,void 0);yield{event:i.event,data:o}}}a=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{a||t.abort()}}return new pe(s,t)}static fromReadableStream(e,t){let n=!1;async function*s(){const i=new Te,o=Ks(e);for await(const c of o)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const o of s())i||o&&(yield JSON.parse(o));i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||t.abort()}}return new pe(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=a=>({next:()=>{if(a.length===0){const i=n.next();e.push(i),t.push(i)}return a.shift()}});return[new pe(()=>s(e),this.controller),new pe(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new Ns({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:i}=await t.next();if(i)return s.close();const o=n.encode(JSON.stringify(a)+`
`);s.enqueue(o)}catch(a){s.error(a)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}}async function*Ur(r,e){if(!r.body)throw e.abort(),new N("Attempted to iterate over a response with no body");const t=new Xr,n=new Te,s=Ks(r.body);for await(const a of qr(s))for(const i of n.decode(a)){const o=t.decode(i);o&&(yield o)}for(const a of n.flush()){const i=t.decode(a);i&&(yield i)}}async function*qr(r){let e=new Uint8Array;for await(const t of r){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let a;for(;(a=Hr(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}function Hr(r){for(let n=0;n<r.length-2;n++){if(r[n]===10&&r[n+1]===10||r[n]===13&&r[n+1]===13)return n+2;if(r[n]===13&&r[n+1]===10&&n+3<r.length&&r[n+2]===13&&r[n+3]===10)return n+4}return-1}class Xr{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=Jr(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}class Te{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=Te.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(Te.NEWLINE_REGEXP);return n&&s.pop(),s.length===1&&!n?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),n||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new N(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new N(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new N("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Te.NEWLINE_CHARS=new Set([`
`,"\r"]);Te.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Jr(r,e){const t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}function Ks(r){if(r[Symbol.asyncIterator])return r;const e=r.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Ys=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",Qs=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&Zs(r),Zs=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",zr=r=>Qs(r)||Ys(r)||Vs(r);async function $s(r,e,t){var s;if(r=await r,t??(t=Qs(r)?{lastModified:r.lastModified,type:r.type}:{}),Ys(r)){const a=await r.blob();return e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new yn([a],e,t)}const n=await Gr(r);if(e||(e=Yr(r)??"unknown_file"),!t.type){const a=(s=n[0])==null?void 0:s.type;typeof a=="string"&&(t={...t,type:a})}return new yn(n,e,t)}async function Gr(r){var t;let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(Zs(r))e.push(await r.arrayBuffer());else if(Qr(r))for await(const n of r)e.push(n);else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${(t=r==null?void 0:r.constructor)==null?void 0:t.name}; props: ${Kr(r)}`);return e}function Kr(r){return`[${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}function Yr(r){var e;return fn(r.name)||fn(r.filename)||((e=fn(r.path))==null?void 0:e.split(/[\\/]/).pop())}const fn=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},Qr=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",Qn=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody",at=async r=>{const e=await Zr(r.body);return Bs(e,r)},Zr=async r=>{const e=new Ds;return await Promise.all(Object.entries(r||{}).map(([t,n])=>vn(e,t,n))),e},vn=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(zr(t)){const n=await $s(t);r.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>vn(r,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,s])=>vn(r,`${e}[${n}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Be={},$r=function(r,e,t,n,s){if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t},ea=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},ft;async function er(r){const{response:e}=r;if(r.options.stream)return je("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):pe.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const a=await e.json();return je("response",e.status,e.url,e.headers,a),a}const s=await e.text();return je("response",e.status,e.url,e.headers,s),s}class un extends Promise{constructor(e,t=er){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new un(this.responsePromise,async t=>e(await this.parseResponse(t)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class ta{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:s,fetch:a}){this.baseURL=e,this.maxRetries=mn("maxRetries",t),this.timeout=mn("timeout",n),this.httpAgent=s,this.fetch=a??Ms}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...oa(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${ha()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(s=>({method:e,path:t,...s})))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}return null}buildRequest(e){var p;const{method:t,path:n,query:s,headers:a={}}=e,i=Qn(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(i),c=this.buildURL(n,s);"timeout"in e&&mn("timeout",e.timeout);const l=e.timeout??this.timeout,h=e.httpAgent??this.httpAgent??js(c),f=l+1e3;typeof((p=h==null?void 0:h.options)==null?void 0:p.timeout)=="number"&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const y=this.buildHeaders({options:e,headers:a,contentLength:o});return{req:{method:t,...i&&{body:i},headers:y,...h&&{agent:h},signal:e.signal??null},url:c,timeout:l}}buildHeaders({options:e,headers:t,contentLength:n}){const s={};n&&(s["content-length"]=n);const a=this.defaultHeaders(e);return ts(s,a),ts(s,t),Qn(e.body)&&et!=="node"&&delete s["content-type"],this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,s){return Q.generate(e,t,n,s)}request(e,t=null){return new un(this.makeRequest(e,t))}async makeRequest(e,t){var h,f;const n=await e;t==null&&(t=n.maxRetries??this.maxRetries),await this.prepareOptions(n);const{req:s,url:a,timeout:i}=this.buildRequest(n);if(await this.prepareRequest(s,{url:a,options:n}),je("request",a,n,s.headers),(h=n.signal)!=null&&h.aborted)throw new se;const o=new AbortController,c=await this.fetchWithTimeout(a,s,i,o).catch(Sn);if(c instanceof Error){if((f=n.signal)!=null&&f.aborted)throw new se;if(t)return this.retryRequest(n,t);throw c.name==="AbortError"?new Tn:new cn({cause:c})}const l=sa(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const R=`retrying, ${t} attempts remaining`;return je(`response (error; ${R})`,c.status,a,l),this.retryRequest(n,t,l)}const y=await c.text().catch(R=>Sn(R).message),d=la(y),p=d?void 0:y;throw je(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,l,p),this.makeStatusError(c.status,d,p,l)}return{response:c,options:n,controller:o}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new na(this,n,e)}buildURL(e,t){const n=ua(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return nr(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new N(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,s){const{signal:a,...i}=t||{};a&&a.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),n);return this.getRequestClient().fetch.call(void 0,e,{signal:s.signal,...i}).finally(()=>{clearTimeout(o)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let s;const a=n==null?void 0:n["retry-after-ms"];if(a){const o=parseFloat(a);Number.isNaN(o)||(s=o)}const i=n==null?void 0:n["retry-after"];if(i&&!s){const o=parseFloat(i);Number.isNaN(o)?s=Date.parse(i)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await ht(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,i=Math.min(.5*Math.pow(2,a),8),o=1-Math.random()*.25;return i*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Oe}`}}class tr{constructor(e,t,n,s){ft.set(this,void 0),$r(this,ft,e),this.options=s,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new N("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,a]of n)e.url.searchParams.set(s,a);t.query=void 0,t.path=e.url.toString()}return await ea(this,ft,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(ft=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class na extends un{constructor(e,t,n){super(t,async s=>new n(e,s.response,await er(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const sa=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),ra={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0,__streamClass:!0},re=r=>typeof r=="object"&&r!==null&&!nr(r)&&Object.keys(r).every(e=>sr(ra,e)),aa=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":$n(Deno.build.os),"X-Stainless-Arch":Zn(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":$n(process.platform),"X-Stainless-Arch":Zn(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const r=ia();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ia(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of r){const n=t.exec(navigator.userAgent);if(n){const s=n[1]||0,a=n[2]||0,i=n[3]||0;return{browser:e,version:`${s}.${a}.${i}`}}}return null}const Zn=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",$n=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let es;const oa=()=>es??(es=aa()),la=r=>{try{return JSON.parse(r)}catch{return}},ca=new RegExp("^(?:[a-z]+:)?//","i"),ua=r=>ca.test(r),ht=r=>new Promise(e=>setTimeout(e,r)),mn=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new N(`${r} must be an integer`);if(e<0)throw new N(`${r} must be a positive integer`);return e},Sn=r=>r instanceof Error?r:new Error(r),mt=r=>{var e,t,n,s;if(typeof process<"u")return((e=Be==null?void 0:Be[r])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,r))==null?void 0:s.trim()};function nr(r){if(!r)return!0;for(const e in r)return!1;return!0}function sr(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function ts(r,e){for(const t in e){if(!sr(e,t))continue;const n=t.toLowerCase();if(!n)continue;const s=e[t];s===null?delete r[n]:s!==void 0&&(r[n]=s)}}function je(r,...e){typeof process<"u"&&(Be==null?void 0:Be.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${r}`,...e)}const ha=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),da=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function ns(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}let Fn=class extends tr{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};class fe extends tr{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class U{constructor(e){this._client=e}}let Ot=class extends U{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}};Ot||(Ot={});let Mt=class extends U{constructor(){super(...arguments),this.completions=new Ot(this._client)}};(function(r){r.Completions=Ot})(Mt||(Mt={}));class Dt extends U{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}}Dt||(Dt={});class Nt extends U{create(e,t){return this._client.post("/audio/transcriptions",at({body:e,...t}))}}Nt||(Nt={});class Bt extends U{create(e,t){return this._client.post("/audio/translations",at({body:e,...t}))}}Bt||(Bt={});class jt extends U{constructor(){super(...arguments),this.transcriptions=new Nt(this._client),this.translations=new Bt(this._client),this.speech=new Dt(this._client)}}(function(r){r.Transcriptions=Nt,r.Translations=Bt,r.Speech=Dt})(jt||(jt={}));class Lt extends U{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return re(e)?this.list({},e):this._client.getAPIList("/batches",On,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class On extends fe{}(function(r){r.BatchesPage=On})(Lt||(Lt={}));class Vt extends U{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return re(e)?this.list({},e):this._client.getAPIList("/assistants",Mn,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Mn extends fe{}(function(r){r.AssistantsPage=Mn})(Vt||(Vt={}));function ss(r){return typeof r.parse=="function"}const Le=r=>(r==null?void 0:r.role)==="assistant",rr=r=>(r==null?void 0:r.role)==="function",ar=r=>(r==null?void 0:r.role)==="tool";var le=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},D=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Z,_t,wt,qe,He,bt,Xe,ye,Je,yt,vt,Me,xn,Wt,Cn,kn,An,En,ir,Rn;const rs=10;class or{constructor(){Z.add(this),this.controller=new AbortController,_t.set(this,void 0),wt.set(this,()=>{}),qe.set(this,()=>{}),He.set(this,void 0),bt.set(this,()=>{}),Xe.set(this,()=>{}),ye.set(this,{}),this._chatCompletions=[],this.messages=[],Je.set(this,!1),yt.set(this,!1),vt.set(this,!1),Me.set(this,!1),En.set(this,e=>{if(le(this,yt,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new se),e instanceof se)return le(this,vt,!0,"f"),this._emit("abort",e);if(e instanceof N)return this._emit("error",e);if(e instanceof Error){const t=new N(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new N(String(e)))}),le(this,_t,new Promise((e,t)=>{le(this,wt,e,"f"),le(this,qe,t,"f")}),"f"),le(this,He,new Promise((e,t)=>{le(this,bt,e,"f"),le(this,Xe,t,"f")}),"f"),D(this,_t,"f").catch(()=>{}),D(this,He,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},D(this,En,"f"))},0)}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(rr(e)||ar(e))&&e.content)this._emit("functionCallResult",e.content);else if(Le(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Le(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}_connected(){this.ended||(D(this,wt,"f").call(this),this._emit("connect"))}get ended(){return D(this,Je,"f")}get errored(){return D(this,yt,"f")}get aborted(){return D(this,vt,"f")}abort(){this.controller.abort()}on(e,t){return(D(this,ye,"f")[e]||(D(this,ye,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=D(this,ye,"f")[e];if(!n)return this;const s=n.findIndex(a=>a.listener===t);return s>=0&&n.splice(s,1),this}once(e,t){return(D(this,ye,"f")[e]||(D(this,ye,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{le(this,Me,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){le(this,Me,!0,"f"),await D(this,He,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new N("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),D(this,Z,"m",xn).call(this)}async finalMessage(){return await this.done(),D(this,Z,"m",Wt).call(this)}async finalFunctionCall(){return await this.done(),D(this,Z,"m",Cn).call(this)}async finalFunctionCallResult(){return await this.done(),D(this,Z,"m",kn).call(this)}async totalUsage(){return await this.done(),D(this,Z,"m",An).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...t){if(D(this,Je,"f"))return;e==="end"&&(le(this,Je,!0,"f"),D(this,bt,"f").call(this));const n=D(this,ye,"f")[e];if(n&&(D(this,ye,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!D(this,Me,"f")&&!(n!=null&&n.length)&&Promise.reject(s),D(this,qe,"f").call(this,s),D(this,Xe,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!D(this,Me,"f")&&!(n!=null&&n.length)&&Promise.reject(s),D(this,qe,"f").call(this,s),D(this,Xe,"f").call(this,s),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=D(this,Z,"m",Wt).call(this);t&&this._emit("finalMessage",t);const n=D(this,Z,"m",xn).call(this);n&&this._emit("finalContent",n);const s=D(this,Z,"m",Cn).call(this);s&&this._emit("finalFunctionCall",s);const a=D(this,Z,"m",kn).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",D(this,Z,"m",An).call(this))}async _createChatCompletion(e,t,n){const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),D(this,Z,"m",ir).call(this,t);const a=await e.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(a)}async _runChatCompletion(e,t,n){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){var y;const s="function",{function_call:a="auto",stream:i,...o}=t,c=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:l=rs}=n||{},h={};for(const d of t.functions)h[d.name||d.function.name]=d;const f=t.functions.map(d=>({name:d.name||d.function.name,parameters:d.parameters,description:d.description}));for(const d of t.messages)this._addMessage(d,!1);for(let d=0;d<l;++d){const b=(y=(await this._createChatCompletion(e,{...o,function_call:a,functions:f,messages:[...this.messages]},n)).choices[0])==null?void 0:y.message;if(!b)throw new N("missing message in ChatCompletion response");if(!b.function_call)return;const{name:P,arguments:R}=b.function_call,u=h[P];if(u){if(c&&c!==P){const v=`Invalid function_call: ${JSON.stringify(P)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:P,content:v});continue}}else{const v=`Invalid function_call: ${JSON.stringify(P)}. Available options are: ${f.map(x=>JSON.stringify(x.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:P,content:v});continue}let w;try{w=ss(u)?await u.parse(R):R}catch(v){this._addMessage({role:s,name:P,content:v instanceof Error?v.message:String(v)});continue}const m=await u.function(w,this),_=D(this,Z,"m",Rn).call(this,m);if(this._addMessage({role:s,name:P,content:_}),c)return}}async _runTools(e,t,n){var y,d;const s="tool",{tool_choice:a="auto",stream:i,...o}=t,c=typeof a!="string"&&((y=a==null?void 0:a.function)==null?void 0:y.name),{maxChatCompletions:l=rs}=n||{},h={};for(const p of t.tools)p.type==="function"&&(h[p.function.name||p.function.function.name]=p.function);const f="tools"in t?t.tools.map(p=>p.type==="function"?{type:"function",function:{name:p.function.name||p.function.function.name,parameters:p.function.parameters,description:p.function.description}}:p):void 0;for(const p of t.messages)this._addMessage(p,!1);for(let p=0;p<l;++p){const P=(d=(await this._createChatCompletion(e,{...o,tool_choice:a,tools:f,messages:[...this.messages]},n)).choices[0])==null?void 0:d.message;if(!P)throw new N("missing message in ChatCompletion response");if(!P.tool_calls)return;for(const R of P.tool_calls){if(R.type!=="function")continue;const u=R.id,{name:w,arguments:m}=R.function,_=h[w];if(_){if(c&&c!==w){const T=`Invalid tool_call: ${JSON.stringify(w)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:u,content:T});continue}}else{const T=`Invalid tool_call: ${JSON.stringify(w)}. Available options are: ${f.map(W=>JSON.stringify(W.function.name)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:u,content:T});continue}let v;try{v=ss(_)?await _.parse(m):m}catch(T){const W=T instanceof Error?T.message:String(T);this._addMessage({role:s,tool_call_id:u,content:W});continue}const x=await _.function(v,this),C=D(this,Z,"m",Rn).call(this,x);if(this._addMessage({role:s,tool_call_id:u,content:C}),c)return}}}}_t=new WeakMap,wt=new WeakMap,qe=new WeakMap,He=new WeakMap,bt=new WeakMap,Xe=new WeakMap,ye=new WeakMap,Je=new WeakMap,yt=new WeakMap,vt=new WeakMap,Me=new WeakMap,En=new WeakMap,Z=new WeakSet,xn=function(){return D(this,Z,"m",Wt).call(this).content??null},Wt=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Le(t))return{...t,content:t.content??null}}throw new N("stream ended without producing a ChatCompletionMessage with role=assistant")},Cn=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(Le(s)&&(s!=null&&s.function_call))return s.function_call;if(Le(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},kn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(rr(t)&&t.content!=null||ar(t)&&t.content!=null&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},An=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},ir=function(e){if(e.n!=null&&e.n>1)throw new N("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Rn=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class it extends or{static runFunctions(e,t,n){const s=new it,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,n){const s=new it,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}_addMessage(e){super._addMessage(e),Le(e)&&e.content&&this._emit("content",e.content)}}var ce=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},gn=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},me,ke,pn,_n,gt,as;class ot extends or{constructor(){super(...arguments),me.add(this),ke.set(this,void 0)}get currentChatCompletionSnapshot(){return ce(this,ke,"f")}static fromReadableStream(e){const t=new ot;return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const s=new ot;return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,n){var i;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ce(this,me,"m",pn).call(this);const a=await e.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of a)ce(this,me,"m",_n).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new se;return this._addChatCompletion(ce(this,me,"m",gt).call(this))}async _fromReadableStream(e,t){var i;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),ce(this,me,"m",pn).call(this),this._connected();const s=pe.fromReadableStream(e,this.controller);let a;for await(const o of s)a&&a!==o.id&&this._addChatCompletion(ce(this,me,"m",gt).call(this)),ce(this,me,"m",_n).call(this,o),a=o.id;if((i=s.controller.signal)!=null&&i.aborted)throw new se;return this._addChatCompletion(ce(this,me,"m",gt).call(this))}[(ke=new WeakMap,me=new WeakSet,pn=function(){this.ended||gn(this,ke,void 0,"f")},_n=function(t){var i,o,c;if(this.ended)return;const n=ce(this,me,"m",as).call(this,t);this._emit("chunk",t,n);const s=(o=(i=t.choices[0])==null?void 0:i.delta)==null?void 0:o.content,a=(c=n.choices[0])==null?void 0:c.message;s!=null&&(a==null?void 0:a.role)==="assistant"&&(a!=null&&a.content)&&this._emit("content",s,a.content)},gt=function(){if(this.ended)throw new N("stream has ended, this shouldn't happen");const t=ce(this,ke,"f");if(!t)throw new N("request ended without sending any chunks");return gn(this,ke,void 0,"f"),fa(t)},as=function(t){var n,s,a;let i=ce(this,ke,"f");const{choices:o,...c}=t;i?Object.assign(i,c):i=gn(this,ke,{...c,choices:[]},"f");for(const{delta:l,finish_reason:h,index:f,logprobs:y=null,...d}of t.choices){let p=i.choices[f];if(p||(p=i.choices[f]={finish_reason:h,index:f,message:{},logprobs:y,...d}),y)if(!p.logprobs)p.logprobs=Object.assign({},y);else{const{content:m,..._}=y;Object.assign(p.logprobs,_),m&&((n=p.logprobs).content??(n.content=[]),p.logprobs.content.push(...m))}if(h&&(p.finish_reason=h),Object.assign(p,d),!l)continue;const{content:b,function_call:P,role:R,tool_calls:u,...w}=l;if(Object.assign(p.message,w),b&&(p.message.content=(p.message.content||"")+b),R&&(p.message.role=R),P&&(p.message.function_call?(P.name&&(p.message.function_call.name=P.name),P.arguments&&((s=p.message.function_call).arguments??(s.arguments=""),p.message.function_call.arguments+=P.arguments)):p.message.function_call=P),u){p.message.tool_calls||(p.message.tool_calls=[]);for(const{index:m,id:_,type:v,function:x,...C}of u){const T=(a=p.message.tool_calls)[m]??(a[m]={});Object.assign(T,C),_&&(T.id=_),v&&(T.type=v),x&&(T.function??(T.function={arguments:""})),x!=null&&x.name&&(T.function.name=x.name),x!=null&&x.arguments&&(T.function.arguments+=x.arguments)}}}return i},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{n=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{n=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new pe(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function fa(r){const{id:e,choices:t,created:n,model:s,system_fingerprint:a,...i}=r;return{...i,id:e,choices:t.map(({message:o,finish_reason:c,index:l,logprobs:h,...f})=>{if(!c)throw new N(`missing finish_reason for choice ${l}`);const{content:y=null,function_call:d,tool_calls:p,...b}=o,P=o.role;if(!P)throw new N(`missing role for choice ${l}`);if(d){const{arguments:R,name:u}=d;if(R==null)throw new N(`missing function_call.arguments for choice ${l}`);if(!u)throw new N(`missing function_call.name for choice ${l}`);return{...f,message:{content:y,function_call:{arguments:R,name:u},role:P},finish_reason:c,index:l,logprobs:h}}return p?{...f,index:l,finish_reason:c,logprobs:h,message:{...b,role:P,content:y,tool_calls:p.map((R,u)=>{const{function:w,type:m,id:_,...v}=R,{arguments:x,name:C,...T}=w||{};if(_==null)throw new N(`missing choices[${l}].tool_calls[${u}].id
${pt(r)}`);if(m==null)throw new N(`missing choices[${l}].tool_calls[${u}].type
${pt(r)}`);if(C==null)throw new N(`missing choices[${l}].tool_calls[${u}].function.name
${pt(r)}`);if(x==null)throw new N(`missing choices[${l}].tool_calls[${u}].function.arguments
${pt(r)}`);return{...v,id:_,type:m,function:{...T,name:C,arguments:x}}})}}:{...f,message:{...b,content:y,role:P},finish_reason:c,index:l,logprobs:h}}),created:n,model:s,object:"chat.completion",...a?{system_fingerprint:a}:{}}}function pt(r){return JSON.stringify(r)}class Ve extends ot{static fromReadableStream(e){const t=new Ve;return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const s=new Ve,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,n){const s=new Ve,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}}let lr=class extends U{runFunctions(e,t){return e.stream?Ve.runFunctions(this._client.chat.completions,e,t):it.runFunctions(this._client.chat.completions,e,t)}runTools(e,t){return e.stream?Ve.runTools(this._client.chat.completions,e,t):it.runTools(this._client.chat.completions,e,t)}stream(e,t){return ot.createChatCompletion(this._client.chat.completions,e,t)}},Ut=class extends U{constructor(){super(...arguments),this.completions=new lr(this._client)}};(function(r){r.Completions=lr})(Ut||(Ut={}));var ue=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},H=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},St,xt,ze,Ge,Ct,Ke,ve,Ye,kt,At,De,Pn;class ma{constructor(){this.controller=new AbortController,St.set(this,void 0),xt.set(this,()=>{}),ze.set(this,()=>{}),Ge.set(this,void 0),Ct.set(this,()=>{}),Ke.set(this,()=>{}),ve.set(this,{}),Ye.set(this,!1),kt.set(this,!1),At.set(this,!1),De.set(this,!1),Pn.set(this,e=>{if(ue(this,kt,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new se),e instanceof se)return ue(this,At,!0,"f"),this._emit("abort",e);if(e instanceof N)return this._emit("error",e);if(e instanceof Error){const t=new N(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new N(String(e)))}),ue(this,St,new Promise((e,t)=>{ue(this,xt,e,"f"),ue(this,ze,t,"f")}),"f"),ue(this,Ge,new Promise((e,t)=>{ue(this,Ct,e,"f"),ue(this,Ke,t,"f")}),"f"),H(this,St,"f").catch(()=>{}),H(this,Ge,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emit("end")},H(this,Pn,"f"))},0)}_addRun(e){return e}_connected(){this.ended||(H(this,xt,"f").call(this),this._emit("connect"))}get ended(){return H(this,Ye,"f")}get errored(){return H(this,kt,"f")}get aborted(){return H(this,At,"f")}abort(){this.controller.abort()}on(e,t){return(H(this,ve,"f")[e]||(H(this,ve,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=H(this,ve,"f")[e];if(!n)return this;const s=n.findIndex(a=>a.listener===t);return s>=0&&n.splice(s,1),this}once(e,t){return(H(this,ve,"f")[e]||(H(this,ve,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{ue(this,De,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){ue(this,De,!0,"f"),await H(this,Ge,"f")}_emit(e,...t){if(H(this,Ye,"f"))return;e==="end"&&(ue(this,Ye,!0,"f"),H(this,Ct,"f").call(this));const n=H(this,ve,"f")[e];if(n&&(H(this,ve,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!H(this,De,"f")&&!(n!=null&&n.length)&&Promise.reject(s),H(this,ze,"f").call(this,s),H(this,Ke,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!H(this,De,"f")&&!(n!=null&&n.length)&&Promise.reject(s),H(this,ze,"f").call(this,s),H(this,Ke,"f").call(this,s),this._emit("end")}}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,s){return await this._createAssistantStream(t,e,n,s)}async _runToolAssistantStream(e,t,n,s,a){return await this._createToolAssistantStream(n,e,t,s,a)}async _createThreadAssistantStream(e,t,n){const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a=await e.createAndRun({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addRun(a)}async _createToolAssistantStream(e,t,n,s,a){const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o=await e.submitToolOutputs(t,n,{...s,stream:!1},{...a,signal:this.controller.signal});return this._connected(),this._addRun(o)}async _createAssistantStream(e,t,n,s){const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i=await e.create(t,{...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addRun(i)}}St=new WeakMap,xt=new WeakMap,ze=new WeakMap,Ge=new WeakMap,Ct=new WeakMap,Ke=new WeakMap,ve=new WeakMap,Ye=new WeakMap,kt=new WeakMap,At=new WeakMap,De=new WeakMap,Pn=new WeakMap;var F=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},te=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},K,In,ge,Et,he,Ie,Ne,Re,qt,ne,Rt,Pt,tt,Qe,Ze,is,os,ls,cs,us,hs,ds;class de extends ma{constructor(){super(...arguments),K.add(this),In.set(this,[]),ge.set(this,{}),Et.set(this,{}),he.set(this,void 0),Ie.set(this,void 0),Ne.set(this,void 0),Re.set(this,void 0),qt.set(this,void 0),ne.set(this,void 0),Rt.set(this,void 0),Pt.set(this,void 0),tt.set(this,void 0)}[(In=new WeakMap,ge=new WeakMap,Et=new WeakMap,he=new WeakMap,Ie=new WeakMap,Ne=new WeakMap,Re=new WeakMap,qt=new WeakMap,ne=new WeakMap,Rt=new WeakMap,Pt=new WeakMap,tt=new WeakMap,K=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{n=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{n=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new de;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var a;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=pe.fromReadableStream(e,this.controller);for await(const i of s)F(this,K,"m",Qe).call(this,i);if((a=s.controller.signal)!=null&&a.aborted)throw new se;return this._addRun(F(this,K,"m",Ze).call(this))}toReadableStream(){return new pe(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,s,a){const i=new de;return i._run(()=>i._runToolAssistantStream(e,t,n,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,n,s,a){var l;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},c=await e.submitToolOutputs(t,n,o,{...a,signal:this.controller.signal});this._connected();for await(const h of c)F(this,K,"m",Qe).call(this,h);if((l=c.controller.signal)!=null&&l.aborted)throw new se;return this._addRun(F(this,K,"m",Ze).call(this))}static createThreadAssistantStream(e,t,n){const s=new de;return s._run(()=>s._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,n,s){const a=new de;return a._run(()=>a._runAssistantStream(e,t,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return F(this,Rt,"f")}currentRun(){return F(this,Pt,"f")}currentMessageSnapshot(){return F(this,he,"f")}currentRunStepSnapshot(){return F(this,tt,"f")}async finalRunSteps(){return await this.done(),Object.values(F(this,ge,"f"))}async finalMessages(){return await this.done(),Object.values(F(this,Et,"f"))}async finalRun(){if(await this.done(),!F(this,Ie,"f"))throw Error("Final run was not received.");return F(this,Ie,"f")}async _createThreadAssistantStream(e,t,n){var o;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},i=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const c of i)F(this,K,"m",Qe).call(this,c);if((o=i.controller.signal)!=null&&o.aborted)throw new se;return this._addRun(F(this,K,"m",Ze).call(this))}async _createAssistantStream(e,t,n,s){var c;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.create(t,i,{...s,signal:this.controller.signal});this._connected();for await(const l of o)F(this,K,"m",Qe).call(this,l);if((c=o.controller.signal)!=null&&c.aborted)throw new se;return this._addRun(F(this,K,"m",Ze).call(this))}static accumulateDelta(e,t){for(const[n,s]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=s;continue}let a=e[n];if(a==null){e[n]=s;continue}if(n==="index"||n==="type"){e[n]=s;continue}if(typeof a=="string"&&typeof s=="string")a+=s;else if(typeof a=="number"&&typeof s=="number")a+=s;else if(ns(a)&&ns(s))a=this.accumulateDelta(a,s);else if(Array.isArray(a)&&Array.isArray(s)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...s);continue}}else throw Error(`Unhandled record type: ${n}, deltaValue: ${s}, accValue: ${a}`);e[n]=a}return e}}Qe=function(e){if(!this.ended)switch(te(this,Rt,e,"f"),F(this,K,"m",ls).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":F(this,K,"m",ds).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":F(this,K,"m",os).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":F(this,K,"m",is).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Ze=function(){if(this.ended)throw new N("stream has ended, this shouldn't happen");if(!F(this,Ie,"f"))throw Error("Final run has not been received");return F(this,Ie,"f")},is=function(e){const[t,n]=F(this,K,"m",us).call(this,e,F(this,he,"f"));te(this,he,t,"f"),F(this,Et,"f")[t.id]=t;for(const s of n){const a=t.content[s.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let a=s.text,i=t.content[s.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=F(this,Ne,"f")){if(F(this,Re,"f"))switch(F(this,Re,"f").type){case"text":this._emit("textDone",F(this,Re,"f").text,F(this,he,"f"));break;case"image_file":this._emit("imageFileDone",F(this,Re,"f").image_file,F(this,he,"f"));break}te(this,Ne,s.index,"f")}te(this,Re,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(F(this,Ne,"f")!==void 0){const s=e.data.content[F(this,Ne,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,F(this,he,"f"));break;case"text":this._emit("textDone",s.text,F(this,he,"f"));break}}F(this,he,"f")&&this._emit("messageDone",e.data),te(this,he,void 0,"f")}},os=function(e){const t=F(this,K,"m",cs).call(this,e);switch(te(this,tt,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==F(this,qt,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(F(this,ne,"f")&&this._emit("toolCallDone",F(this,ne,"f")),te(this,qt,a.index,"f"),te(this,ne,t.step_details.tool_calls[a.index],"f"),F(this,ne,"f")&&this._emit("toolCallCreated",F(this,ne,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":te(this,tt,void 0,"f"),e.data.step_details.type=="tool_calls"&&F(this,ne,"f")&&(this._emit("toolCallDone",F(this,ne,"f")),te(this,ne,void 0,"f")),this._emit("runStepDone",e.data,t);break}},ls=function(e){F(this,In,"f").push(e),this._emit("event",e)},cs=function(e){switch(e.event){case"thread.run.step.created":return F(this,ge,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=F(this,ge,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const s=de.accumulateDelta(t,n.delta);F(this,ge,"f")[e.data.id]=s}return F(this,ge,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":F(this,ge,"f")[e.data.id]=e.data;break}if(F(this,ge,"f")[e.data.id])return F(this,ge,"f")[e.data.id];throw new Error("No snapshot available")},us=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const a of s.delta.content)if(a.index in t.content){let i=t.content[a.index];t.content[a.index]=F(this,K,"m",hs).call(this,a,i)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},hs=function(e,t){return de.accumulateDelta(t,e)},ds=function(e){switch(te(this,Pt,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":te(this,Ie,e.data,"f"),F(this,ne,"f")&&(this._emit("toolCallDone",F(this,ne,"f")),te(this,ne,void 0,"f"));break}};class Ht extends U{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},n){return re(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Dn,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Dn extends fe{}(function(r){r.MessagesPage=Dn})(Ht||(Ht={}));class Xt extends U{retrieve(e,t,n,s){return this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t,n={},s){return re(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Nn,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Nn extends fe{}(function(r){r.RunStepsPage=Nn})(Xt||(Xt={}));class Jt extends U{constructor(){super(...arguments),this.steps=new Xt(this._client)}create(e,t,n){return this._client.post(`/threads/${e}/runs`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},n){return re(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Bn,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const s=await this.create(e,t,n);return await this.poll(e,s.id,n)}createAndStream(e,t,n){return de.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await ht(o);break;case"requires_action":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,n){return de.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,s){const a=await this.submitToolOutputs(e,t,n,s);return await this.poll(e,a.id,s)}submitToolOutputsStream(e,t,n,s){return de.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,s)}}class Bn extends fe{}(function(r){r.RunsPage=Bn,r.Steps=Xt,r.RunStepsPage=Nn})(Jt||(Jt={}));class zt extends U{constructor(){super(...arguments),this.runs=new Jt(this._client),this.messages=new Ht(this._client)}create(e={},t){return re(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return de.createThreadAssistantStream(e,this._client.beta.threads,t)}}(function(r){r.Runs=Jt,r.RunsPage=Bn,r.Messages=Ht,r.MessagesPage=Dn})(zt||(zt={}));const ga=async r=>{const e=await Promise.allSettled(r),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const s of e)s.status==="fulfilled"&&n.push(s.value);return n};let Gt=class extends U{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return re(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,hn,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const s=await this.create(e,t,n);return await this.poll(e,s.id,n)}async poll(e,t,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:s}).withResponse(),i=a.data;switch(i.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await ht(o);break;case"failed":case"completed":return i}}}async upload(e,t,n){const s=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:s.id},n)}async uploadAndPoll(e,t,n){const s=await this.upload(e,t,n);return await this.poll(e,s.id,n)}};class hn extends fe{}(function(r){r.VectorStoreFilesPage=hn})(Gt||(Gt={}));class Kt extends U{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const s=await this.create(e,t);return await this.poll(e,s.id,n)}listFiles(e,t,n={},s){return re(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,hn,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,t,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:s}).withResponse();switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await ht(o);break;case"failed":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},s){if(t===null||t.length==0)throw new Error("No files provided to process.");const a=(s==null?void 0:s.maxConcurrency)??5,i=Math.min(a,t.length),o=this._client,c=t.values(),l=[...n];async function h(y){for(let d of y){const p=await o.files.create({file:d,purpose:"assistants"},s);l.push(p.id)}}const f=Array(i).fill(c).map(h);return await ga(f),await this.createAndPoll(e,{file_ids:l})}}Kt||(Kt={});class Yt extends U{constructor(){super(...arguments),this.files=new Gt(this._client),this.fileBatches=new Kt(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return re(e)?this.list({},e):this._client.getAPIList("/vector_stores",jn,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class jn extends fe{}(function(r){r.VectorStoresPage=jn,r.Files=Gt,r.VectorStoreFilesPage=hn,r.FileBatches=Kt})(Yt||(Yt={}));class Qt extends U{constructor(){super(...arguments),this.vectorStores=new Yt(this._client),this.chat=new Ut(this._client),this.assistants=new Vt(this._client),this.threads=new zt(this._client)}}(function(r){r.VectorStores=Yt,r.VectorStoresPage=jn,r.Chat=Ut,r.Assistants=Vt,r.AssistantsPage=Mn,r.Threads=zt})(Qt||(Qt={}));class Zt extends U{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}Zt||(Zt={});class $t extends U{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}$t||($t={});class en extends U{create(e,t){return this._client.post("/files",at({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return re(e)?this.list({},e):this._client.getAPIList("/files",Ln,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t==null?void 0:t.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!s.has(i.status);)if(await ht(t),i=await this.retrieve(e),Date.now()-a>n)throw new Tn({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}}class Ln extends Fn{}(function(r){r.FileObjectsPage=Ln})(en||(en={}));class tn extends U{list(e,t={},n){return re(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Vn,{query:t,...n})}}class Vn extends fe{}(function(r){r.FineTuningJobCheckpointsPage=Vn})(tn||(tn={}));class nn extends U{constructor(){super(...arguments),this.checkpoints=new tn(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return re(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Wn,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return re(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Un,{query:t,...n})}}class Wn extends fe{}class Un extends fe{}(function(r){r.FineTuningJobsPage=Wn,r.FineTuningJobEventsPage=Un,r.Checkpoints=tn,r.FineTuningJobCheckpointsPage=Vn})(nn||(nn={}));class sn extends U{constructor(){super(...arguments),this.jobs=new nn(this._client)}}(function(r){r.Jobs=nn,r.FineTuningJobsPage=Wn,r.FineTuningJobEventsPage=Un})(sn||(sn={}));class rn extends U{createVariation(e,t){return this._client.post("/images/variations",at({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",at({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}rn||(rn={});class an extends U{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",qn,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class qn extends Fn{}(function(r){r.ModelsPage=qn})(an||(an={}));class on extends U{create(e,t){return this._client.post("/moderations",{body:e,...t})}}on||(on={});var cr;class X extends ta{constructor({baseURL:e=mt("OPENAI_BASE_URL"),apiKey:t=mt("OPENAI_API_KEY"),organization:n=mt("OPENAI_ORG_ID")??null,project:s=mt("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new N("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:n,project:s,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&da())throw new N(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Zt(this),this.chat=new Mt(this),this.embeddings=new $t(this),this.files=new en(this),this.images=new rn(this),this.audio=new jt(this),this.moderations=new on(this),this.models=new an(this),this.fineTuning=new sn(this),this.beta=new Qt(this),this.batches=new Lt(this),this._options=i,this.apiKey=t,this.organization=n,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}cr=X;X.OpenAI=cr;X.OpenAIError=N;X.APIError=Q;X.APIConnectionError=cn;X.APIConnectionTimeoutError=Tn;X.APIUserAbortError=se;X.NotFoundError=Hs;X.ConflictError=Xs;X.RateLimitError=zs;X.BadRequestError=Ws;X.AuthenticationError=Us;X.InternalServerError=Gs;X.PermissionDeniedError=qs;X.UnprocessableEntityError=Js;X.toFile=$s;X.fileFromPath=Ls;(function(r){r.Page=Fn,r.CursorPage=fe,r.Completions=Zt,r.Chat=Mt,r.Embeddings=$t,r.Files=en,r.FileObjectsPage=Ln,r.Images=rn,r.Audio=jt,r.Moderations=on,r.Models=an,r.ModelsPage=qn,r.FineTuning=sn,r.Beta=Qt,r.Batches=Lt,r.BatchesPage=On})(X||(X={}));var ur={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.parse=void 0;function e(u){if(u!==void 0){if(u===null)return null;if(u==="")return"";try{return JSON.parse(u)}catch(w){const[m,_]=u.trimLeft()[0]===":"?t(u,w):t(u,w,y);return e.lastParseReminding=_,e.onExtraToken&&_.length>0&&e.onExtraToken(u,m,_),m}}}r.parse=e,function(u){u.onExtraToken=(w,m,_)=>{console.error("parsed json with extra tokens:",{text:w,data:m,reminding:_})}}(e=r.parse||(r.parse={}));function t(u,w,m){const _=s[u[0]]||m;if(!_)throw console.error(`no parser registered for ${JSON.stringify(u[0])}:`,{s:u}),w;return _(u,w)}function n(u,w,m){return u[0]==='"'?h(u):u[0]==="'"?f(u):y(u,w,m)}const s={};function a(u){return u.trimLeft()}s[" "]=i,s["\r"]=i,s[`
`]=i,s["	"]=i;function i(u,w){return u=a(u),t(u,w)}s["["]=o;function o(u,w){u=u.substr(1);const m=[];for(u=a(u);u.length>0;){if(u[0]==="]"){u=u.substr(1);break}const _=t(u,w,(v,x)=>y(v,x,[",","]"]));m.push(_[0]),u=_[1],u=a(u),u[0]===","&&(u=u.substring(1),u=a(u))}return[m,u]}for(const u of"0123456789.-".slice())s[u]=c;function c(u){for(let w=0;w<u.length;w++){const m=u[w];if(s[m]===c)continue;const _=u.substring(0,w);return u=u.substring(w),[l(_),u]}return[l(u),""]}function l(u){if(u==="-")return-0;const w=+u;return Number.isNaN(w)?u:w}s['"']=h;function h(u){for(let w=1;w<u.length;w++){const m=u[w];if(m==="\\"){w++;continue}if(m==='"'){const _=u.substring(0,w+1).replace(/\n/g,"\\n");return u=u.substring(w+1),[JSON.parse(_),u]}}return[JSON.parse(u+'"'),""]}s["'"]=f;function f(u){for(let w=1;w<u.length;w++){const m=u[w];if(m==="\\"){w++;continue}if(m==="'"){const _=u.substring(0,w+1).replace(/\n/g,"\\n");return u=u.substring(w+1),[JSON.parse('"'+_.slice(1,-1)+'"'),u]}}return[JSON.parse('"'+u.slice(1)+'"'),""]}function y(u,w,m=[" "]){const _=Math.min(...m.map(C=>{const T=u.indexOf(C);return T===-1?u.length:T})),v=u.substring(0,_).trim(),x=u.substring(_);return[v,x]}s["{"]=d;function d(u,w){u=u.substr(1);const m={};for(u=a(u);u.length>0;){if(u[0]==="}"){u=u.substr(1);break}const _=n(u,w,[":","}"]),v=_[0];if(u=_[1],u=a(u),u[0]!==":"){m[v]=void 0;break}if(u=u.substr(1),u=a(u),u.length===0){m[v]=void 0;break}const x=t(u,w);m[v]=x[0],u=x[1],u=a(u),u[0]===","&&(u=u.substr(1),u=a(u))}return[m,u]}s.t=p;function p(u,w){return R(u,"true",!0,w)}s.f=b;function b(u,w){return R(u,"false",!1,w)}s.n=P;function P(u,w){return R(u,"null",null,w)}function R(u,w,m,_){for(let v=w.length;v>=1;v--)if(u.startsWith(w.slice(0,v)))return[m,u.slice(v)];{const v=JSON.stringify(u.slice(0,w.length));throw console.error(`unknown token starting with ${v}:`,{s:u}),_}}})(ur);const pa=[{name:"Brokerageâ€“The Fidelity AccountÂ®",description:"This multi-feature trading and investing account allows you to select from a broad range of investment choices, including stocks, bonds, ETFs, options, and mutual funds."},{name:"Roth IRA",description:"Save for retirement with after-tax dollars and withdraw the money tax-free in retirement."},{name:"Rollover IRA",description:"Consolidate your old 401(k) and workplace accounts into a centralized account without taxes or penalties."},{name:"Traditional IRA",description:"Save for retirement and reduce your taxable income, if eligible, and your potential earnings could grow tax-deferred."},{name:"Fidelity Cash Management Account",description:"This account offers you ways to spend, save, and invest, plus features of a traditional checking account."},{name:"Fidelity GoÂ®",description:"Our robo advisor makes investing quick, simple, and affordable. Weâ€™ll handle the investing so you don't have to."},{name:"Inherited IRA",description:"An account specifically designed for retirement plan beneficiariesâ€”those who have inherited an IRA or workplace savings plan, such as a 401(k)."},{name:"Fidelity HSAÂ®",description:"Investing your health savings account (HSA) for potential tax-free growth can help you save for qualified medical expenses."},{name:"Custodial Account",description:"This account is a way to save or give a financial gift to a child. Funds can be invested in a range of optionsâ€”all to give a child a better future."},{name:"SEP IRA",description:"This account helps self-employed individuals and small-business owners get access to a tax-deferred benefit when saving for retirement."},{name:"Fidelity Youth Account",description:"Teens 13 to 17 own and manage (with parental oversight) this account, where they can learn to save, spend, and invest in one secure place."},{name:"529 Account",description:"This account is flexible, tax-advantaged, and designed specifically for education savings. Funds can be used for qualified educational expenses at schools nationwide."},{name:"Trust Account",description:"A trust can help you protect your legacy and provide you with greater control over how your wealth is distributed."},{name:"Roth IRAâ€“Fidelity GoÂ®",description:"An account that lets you grow your retirement savings with after-tax dollars and withdraw the money tax-free when you need it."},{name:"Roth IRAâ€“Managed FidFoliosâ„ ",description:"An account that lets you grow your retirement savings with after-tax dollars and withdraw the money tax-free when you need it."},{name:"Inherited Roth IRA",description:"An account specifically designed for retirement plan beneficiariesâ€”those who inherit a Roth IRA or workplace savings plan, such as a Roth 401(k)."},{name:"Rollover IRAâ€“Fidelity GoÂ®",description:"We choose and manage your investments using your goals and risk tolerance in this digitally managed account."},{name:"Rollover IRAâ€“Managed FidFoliosâ„ ",description:"Our team chooses the stocks for your portfolio and then makes all the trades, keeping you informed along the way."},{name:"Traditional IRAâ€“Managed FidFoliosâ„ ",description:"Save for retirement and have your potential earnings grow tax-deferred in this account. You also may be able to deduct your contributions."},{name:"Traditional IRAâ€“Fidelity GoÂ®",description:"Save for retirement and let your potential earnings grow tax-deferred in this account. You also may be able to deduct your contributions."},{name:"Self-employed 401(k)",description:"An account that caters to the needs of self-employed and owner-only businesses."},{name:"SIMPLE IRA",description:"An account to help self-employed individuals and small-business owners with 100 or fewer employees offer tax-advantaged retirement plans."},{name:"Investment-Only Plans for Small Business",description:"This brokerage account is designed for small businesses that have qualified plans and would like to include offerings from Fidelity."},{name:"401(k) Plan for Small Businessesâ„ ",description:"This account has simple plan choices and fewer administrative burdens, helping to limit the time needed to focus on managing a 401(k)."},{name:"Fidelity CryptoÂ®â€“Offered by Fidelity Digital Assetsâ„ ",description:"Open a Fidelity CryptoÂ® account to trade bitcoin and ethereum, and get education that makes sense of this new space."},{name:"The Fidelity AccountÂ® for Businesses",description:"This low-cost account helps you manage your business finances with comprehensive trading, mutual fund, and cash management features."},{name:"Fidelity Managed FidFoliosâ„ ",description:"Choose from 6 investment strategies, customize it, and let our pros go to work for you. We'll look for tax savings to help you keep more of what you earn."},{name:"Portfolio Advisory Services Accounts",description:"Professionally managed, multi-asset class portfolios that can be configured around your comfort with risk, goals, and investment preferences."},{name:"Fidelity Separately Managed Accounts",description:"Personalized, single-asset-class portfolios of individual securities that seek to meet specific objectives, such as dividend income or tax-free interest income."},{name:"Roth IRA for Kids",description:"This is a way to help your child start saving for retirement. Itâ€™s opened on behalf of a child who has earned income and itâ€™s managed by an adult."},{name:"The Attainable Savings PlanÂ®",description:"This account can help individuals with disabilities and their families save for their disability expenses while keeping benefits such as Supplemental Security Income and Medicaid."},{name:"Fidelity GoÂ® HSA",description:"We choose investments for your health savings account (HSA) and help generate tax-free growth as you save for qualified medical expenses."},{name:"Fidelity CharitableÂ® Giving AccountÂ®",description:"This account can help you maximize your impact in a tax-smart way when donating to your favorite charities."},{name:"Estate Account",description:"With this account, you manage investments on behalf of an estate to help protect assets and make distributions."},{name:"Fidelity Personal Retirement AnnuityÂ®",description:"This annuity is an option that allows you to increase your tax-deferred retirement savings beyond the contribution limits of an IRA or 401(k)."},{name:"Deferred Income Annuities",description:"Deferred income annuities provide you, or you and your spouse, a guaranteed income for a set period of time or for the rest of your life."},{name:"Deferred Fixed Annuities",description:"Offer a guaranteed rate of return, with tax deferral, over a set time period."},{name:"Immediate Fixed Income Annuities",description:"Immediate fixed income annuities provide a guaranteed stream of income for the rest of your life or a set period of time."},{name:"Universal Life",description:"Universal life insurance provides lifetime coverage and the ability to leave your loved ones with a lasting legacy."},{name:"Term Life Insurance",description:"Term life insurance can provide loved ones financial protection to help maintain their lifestyle if you were no longer there."},{name:"Fidelity Basket Portfolios",description:"Youâ€™re in control. Pick the stocks and ETFs on your own or get started investing with prebuilt models from the experts."}],hr=new X({apiKey:$e(Ar),dangerouslyAllowBrowser:!0}),_a=async()=>{const r=[{role:"system",content:`
  A user has provided the following information and conversed with a financial chat bot: ${JSON.stringify($e(J))};
  Based on the data provided, your job is to provide up to 3 recommendations of account types detailed below:${JSON.stringify(pa)}
  `},{role:"user",content:`Please provide your recommendations in a JSON object in the following format:
      recommendations = {
        name: Name of Account
        rationale: based on the conversation, why do you recommend this account type.  Length < 1-2 sentences
      }[]
      maximum array size is 3.  If there are fewer than 3 applicable accounts, only return those.
      Return at least 1 recommendation, always;
      In your recommendation, please reference something the user mentioned specifically as a rationale for why this account makes sense
      `}],e=await hr.chat.completions.create({model:"gpt-4-turbo",response_format:{type:"json_object"},messages:r,stream:!1});return JSON.parse(e.choices[0].message.content||"")},fs=async r=>{var i,o;const e=`
  Your job is to help the user figure out which accounts they should open at a large financial institution.
  There are 43 different accounts to choose from and we will help the user.
  Based on their provided information:
  ${JSON.stringify($e(J))}
  Your job is to ask them follow up questions that help determine which accounts they should open.
  Keep your questions friendly and professional.
  Keep your questions open ended and as brief as possible.
  Only ask one question at a time.
  Limit questions to 1-2 sentences MAX.
  Do not ask them about specific accounts, ask about their goals, it is your job to recommend accounts.
  If the user asks a question about any topic not related to their personal finance or account opening, please kindly re-direct the conversation
  Please continue asking questions until they've provided sufficient data to recommend an account
  Please generate JSON output in the format: {
    message: your message to the user;
    complete: (boolean) whether or not the user has provided sufficient data to recommend an account to open
  }
  `,t=r!==""?[{role:"system",content:e},...$e(Pe),{role:"user",content:r}]:[{role:"system",content:e},...$e(Pe)],n=await hr.chat.completions.create({model:"gpt-4-turbo",response_format:{type:"json_object"},messages:t,stream:!0});let s="",a={message:"",complete:!1};Pe.update(c=>[...c,{role:"assistant",content:"..."}]);for await(const c of n)if(s+=((o=(i=c.choices[0])==null?void 0:i.delta)==null?void 0:o.content)||"",s.length>0)try{a=ur.parse(s),Pe.update(l=>[...l.slice(0,-1),{role:"assistant",content:a.message||"..."}])}catch(l){console.log("issue parsing - carry on!",l)}(a==null?void 0:a.complete)===!0&&bn.set(!0)};function ms(r,e,t){const n=r.slice();return n[21]=e[t].role,n[22]=e[t].content,n}function gs(r){let e,t,n='<h4 class="">Your Recommendations are Ready</h4> <button class="border-0">âœ•</button>',s,a,i,o=`Thank you for providing details about your finances! We are ready to provide you with
				recommendations. You may continue chatting with our assistant if you have additional
				questions or see your recommendations now!`,c,l,h,f="Keep Chatting",y,d,p="See Recommendations",b,P;return{c(){e=A("div"),t=A("div"),t.innerHTML=n,s=O(),a=A("div"),i=A("p"),i.textContent=o,c=O(),l=A("div"),h=A("button"),h.textContent=f,y=O(),d=A("button"),d.textContent=p,this.h()},l(R){e=E(R,"DIV",{class:!0});var u=I(e);t=E(u,"DIV",{class:!0,"data-svelte-h":!0}),V(t)!=="svelte-1czx6vq"&&(t.innerHTML=n),s=M(u),a=E(u,"DIV",{class:!0});var w=I(a);i=E(w,"P",{class:!0,"data-svelte-h":!0}),V(i)!=="svelte-1dcopo6"&&(i.textContent=o),c=M(w),l=E(w,"DIV",{class:!0});var m=I(l);h=E(m,"BUTTON",{class:!0,"data-svelte-h":!0}),V(h)!=="svelte-1ya41ei"&&(h.textContent=f),y=M(m),d=E(m,"BUTTON",{class:!0,"data-svelte-h":!0}),V(d)!=="svelte-75egkd"&&(d.textContent=p),m.forEach(k),w.forEach(k),u.forEach(k),this.h()},h(){S(t,"class","flex w-full items-center justify-between bg-fidelity-green-600 px-4 py-2 text-white"),S(i,"class","text-fidelity-neutral-600"),S(h,"class","bg-fidelity-neutral-100"),S(d,"class","bg-fidelity-green-600 text-white"),S(l,"class","flex w-full justify-end gap-2 pt-4"),S(a,"class","p-4"),S(e,"class","modal svelte-15e0aaj")},m(R,u){j(R,e,u),g(e,t),g(e,s),g(e,a),g(a,i),g(a,c),g(a,l),g(l,h),g(l,y),g(l,d),b||(P=[B(h,"click",r[12]),B(d,"click",r[13])],b=!0)},p:q,d(R){R&&k(e),b=!1,Ee(P)}}}function wa(r){let e,t=r[22]+"",n;return{c(){e=A("div"),n=z(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var a=I(e);n=G(a,t),a.forEach(k),this.h()},h(){S(e,"class","ml-auto w-4/5 rounded-lg bg-fidelity-green-600 p-2 text-white")},m(s,a){j(s,e,a),g(e,n)},p(s,a){a&256&&t!==(t=s[22]+"")&&Ae(n,t)},d(s){s&&k(e)}}}function ba(r){let e,t,n=r[22]+"",s,a;return{c(){e=A("div"),t=A("div"),s=z(n),a=O(),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=I(e);t=E(o,"DIV",{class:!0});var c=I(t);s=G(c,n),c.forEach(k),a=M(o),o.forEach(k),this.h()},h(){S(t,"class","rounded-lg bg-slate-200 p-2"),S(e,"class","w-4/5")},m(i,o){j(i,e,o),g(e,t),g(t,s),g(e,a)},p(i,o){o&256&&n!==(n=i[22]+"")&&Ae(s,n)},d(i){i&&k(e)}}}function ps(r){let e;function t(a,i){return a[21]==="assistant"?ba:wa}let n=t(r),s=n(r);return{c(){s.c(),e=Ue()},l(a){s.l(a),e=Ue()},m(a,i){s.m(a,i),j(a,e,i)},p(a,i){n===(n=t(a))&&s?s.p(a,i):(s.d(1),s=n(a),s&&(s.c(),s.m(e.parentNode,e)))},d(a){a&&k(e),s.d(a)}}}function _s(r){let e,t,n,s,a;return t=new Cr({props:{class:"h-4 w-4 text-fidelity-green-600 border-fidelity-green-600"}}),{c(){e=A("button"),nt(t.$$.fragment),this.h()},l(i){e=E(i,"BUTTON",{class:!0});var o=I(e);ln(t.$$.fragment,o),o.forEach(k),this.h()},h(){S(e,"class","absolute bottom-2 right-2")},m(i,o){j(i,e,o),st(t,e,null),n=!0,s||(a=B(e,"click",r[18]),s=!0)},p:q,i(i){n||(Y(t.$$.fragment,i),n=!0)},o(i){$(t.$$.fragment,i),n=!1},d(i){i&&k(e),rt(t),s=!1,a()}}}function ya(r){let e,t,n,s,a,i,o,c,l,h,f="Back",y,d,p,b,P,R,u=r[3]&&gs(r),w=ee(r[8]),m=[];for(let v=0;v<w.length;v+=1)m[v]=ps(ms(r,w,v));let _=r[5].length>4&&_s(r);return{c(){u&&u.c(),e=O(),t=A("div"),n=A("div");for(let v=0;v<m.length;v+=1)m[v].c();s=O(),a=A("div"),i=A("textarea"),o=O(),_&&_.c(),c=O(),l=A("div"),h=A("button"),h.textContent=f,y=O(),d=A("button"),p=z("See Recommendations"),this.h()},l(v){u&&u.l(v),e=M(v),t=E(v,"DIV",{class:!0});var x=I(t);n=E(x,"DIV",{class:!0});var C=I(n);for(let be=0;be<m.length;be+=1)m[be].l(C);C.forEach(k),s=M(x),a=E(x,"DIV",{class:!0});var T=I(a);i=E(T,"TEXTAREA",{class:!0,placeholder:!0}),I(i).forEach(k),o=M(T),_&&_.l(T),c=M(T),l=E(T,"DIV",{class:!0});var W=I(l);h=E(W,"BUTTON",{class:!0,"data-svelte-h":!0}),V(h)!=="svelte-1admezx"&&(h.textContent=f),y=M(W),d=E(W,"BUTTON",{class:!0});var L=I(d);p=G(L,"See Recommendations"),L.forEach(k),W.forEach(k),T.forEach(k),x.forEach(k),this.h()},h(){S(n,"class","mx-auto h-2/3 w-1/2 space-y-4 overflow-y-auto pb-6"),S(i,"class","h-full w-full resize-none rounded-lg p-1.5 text-sm outline-none ring-0"),S(i,"placeholder","Type a message..."),S(h,"class","back"),S(d,"class","next"),d.disabled=r[7],S(l,"class","grid grid-cols-2 w-3/4 mx-auto pt-8 gap-4"),S(a,"class","mx-auto h-16 w-1/2 relative"),S(t,"class","h-[calc(100vh-240px)] pt-[4vh]")},m(v,x){u&&u.m(v,x),j(v,e,x),j(v,t,x),g(t,n);for(let C=0;C<m.length;C+=1)m[C]&&m[C].m(n,null);r[14](n),g(t,s),g(t,a),g(a,i),r[15](i),we(i,r[5]),g(a,o),_&&_.m(a,null),g(a,c),g(a,l),g(l,h),g(l,y),g(l,d),g(d,p),b=!0,P||(R=[B(i,"input",r[16]),B(i,"keydown",r[17]),B(h,"click",r[19]),B(d,"click",r[20])],P=!0)},p(v,[x]){if(v[3]?u?u.p(v,x):(u=gs(v),u.c(),u.m(e.parentNode,e)):u&&(u.d(1),u=null),x&256){w=ee(v[8]);let C;for(C=0;C<w.length;C+=1){const T=ms(v,w,C);m[C]?m[C].p(T,x):(m[C]=ps(T),m[C].c(),m[C].m(n,null))}for(;C<m.length;C+=1)m[C].d(1);m.length=w.length}x&32&&we(i,v[5]),v[5].length>4?_?(_.p(v,x),x&32&&Y(_,1)):(_=_s(v),_.c(),Y(_,1),_.m(a,c)):_&&(lt(),$(_,1,1,()=>{_=null}),ct()),(!b||x&128)&&(d.disabled=v[7])},i(v){b||(Y(_),b=!0)},o(v){$(_),b=!1},d(v){v&&(k(e),k(t)),u&&u.d(v),Fe(m,v),r[14](null),r[15](null),_&&_.d(),P=!1,Ee(R)}}}function va(r,e,t){let n,s,a;_e(r,Pe,C=>t(8,s=C)),_e(r,bn,C=>t(11,a=C));let i=!1,o,c="",l,{back:h}=e,{next:f}=e,{changeStep:y=C=>{}}=e;xe(async()=>{await fs("Please briefly but kindly greet the current user by name and then ask the first question"),Pe.subscribe(C=>{setTimeout(()=>{l&&t(6,l.scrollTop=l.scrollHeight,l)},10)}),bn.subscribe(C=>{C===!0&&t(3,i=!0)}),o&&o.focus()});const d=()=>{Pe.update(C=>[...C,{role:"user",content:o.value}]),J.update(C=>({...C,messages:s})),t(4,o.value="",o),t(5,c=""),o.focus(),fs("")},p=C=>{C.key==="Enter"&&(C.preventDefault(),d())},b=()=>{t(3,i=!1)},P=()=>y(f);function R(C){We[C?"unshift":"push"](()=>{l=C,t(6,l)})}function u(C){We[C?"unshift":"push"](()=>{o=C,t(4,o)})}function w(){c=this.value,t(5,c)}const m=C=>p(C),_=()=>{d()},v=()=>y(h),x=()=>y(f);return r.$$set=C=>{"back"in C&&t(0,h=C.back),"next"in C&&t(1,f=C.next),"changeStep"in C&&t(2,y=C.changeStep)},r.$$.update=()=>{r.$$.dirty&2048&&t(7,n=!a)},[h,f,y,i,o,c,l,n,s,d,p,a,b,P,R,u,w,m,_,v,x]}class Sa extends ie{constructor(e){super(),oe(this,e,va,ya,ae,{back:0,next:1,changeStep:2})}}function xa(r){let e,t,n,s="What's your email?",a,i,o="We'll use this to save your results, so you can see them later",c,l,h,f,y,d="Back",p,b,P,R,u;return{c(){e=A("div"),t=A("div"),n=A("h1"),n.textContent=s,a=O(),i=A("p"),i.textContent=o,c=O(),l=A("textarea"),h=O(),f=A("div"),y=A("button"),y.textContent=d,p=O(),b=A("button"),P=z("Next"),this.h()},l(w){e=E(w,"DIV",{class:!0});var m=I(e);t=E(m,"DIV",{class:!0});var _=I(t);n=E(_,"H1",{class:!0,"data-svelte-h":!0}),V(n)!=="svelte-17nzind"&&(n.textContent=s),a=M(_),i=E(_,"P",{class:!0,"data-svelte-h":!0}),V(i)!=="svelte-trs68f"&&(i.textContent=o),c=M(_),l=E(_,"TEXTAREA",{rows:!0,class:!0}),I(l).forEach(k),h=M(_),f=E(_,"DIV",{class:!0});var v=I(f);y=E(v,"BUTTON",{class:!0,"data-svelte-h":!0}),V(y)!=="svelte-1admezx"&&(y.textContent=d),p=M(v),b=E(v,"BUTTON",{class:!0});var x=I(b);P=G(x,"Next"),x.forEach(k),v.forEach(k),_.forEach(k),m.forEach(k),this.h()},h(){S(n,"class","font-light"),S(i,"class","text-fidelity-neutral-500 my-3"),S(l,"rows","1"),S(l,"class","svelte-zdeguy"),S(y,"class","back"),S(b,"class","next"),b.disabled=r[5],S(f,"class","grid grid-cols-2 w-3/4 mx-auto pt-8 gap-4"),S(t,"class","w-96 h-1/2 mx-auto text-center"),S(e,"class","h-[calc(100vh-112px)] pt-[10vh]")},m(w,m){j(w,e,m),g(e,t),g(t,n),g(t,a),g(t,i),g(t,c),g(t,l),r[7](l),we(l,r[3].email),g(t,h),g(t,f),g(f,y),g(f,p),g(f,b),g(b,P),R||(u=[B(l,"input",r[8]),B(l,"keydown",r[9]),B(y,"click",r[10]),B(b,"click",r[11])],R=!0)},p(w,[m]){m&8&&we(l,w[3].email),m&32&&(b.disabled=w[5])},i:q,o:q,d(w){w&&k(e),r[7](null),R=!1,Ee(u)}}}function Ca(r,e,t){let n,s;_e(r,J,b=>t(3,s=b));let{back:a}=e,{next:i}=e,{changeStep:o=b=>{}}=e,c;xe(()=>{Se.set(!0),c==null||c.focus(),window.scrollTo(0,0)});const l=b=>{b.key==="Enter"&&(b.preventDefault(),o(i))};function h(b){We[b?"unshift":"push"](()=>{c=b,t(4,c)})}function f(){s.email=this.value,J.set(s)}const y=b=>l(b),d=()=>o(a),p=()=>o(i);return r.$$set=b=>{"back"in b&&t(0,a=b.back),"next"in b&&t(1,i=b.next),"changeStep"in b&&t(2,o=b.changeStep)},r.$$.update=()=>{r.$$.dirty&8&&t(5,n=s.email?s.email.length<=4:!0)},[a,i,o,s,c,n,l,h,f,y,d,p]}class ka extends ie{constructor(e){super(),oe(this,e,Ca,xa,ae,{back:0,next:1,changeStep:2})}}function Aa(r){let e,t,n,s="Create your Fidelity Password?",a,i,o="Please choose at least 8 characters, including letters and numbers",c,l,h,f,y,d="Back",p,b,P,R,u;return{c(){e=A("div"),t=A("div"),n=A("h1"),n.textContent=s,a=O(),i=A("p"),i.textContent=o,c=O(),l=A("textarea"),h=O(),f=A("div"),y=A("button"),y.textContent=d,p=O(),b=A("button"),P=z("Next"),this.h()},l(w){e=E(w,"DIV",{class:!0});var m=I(e);t=E(m,"DIV",{class:!0});var _=I(t);n=E(_,"H1",{class:!0,"data-svelte-h":!0}),V(n)!=="svelte-1shi0ru"&&(n.textContent=s),a=M(_),i=E(_,"P",{class:!0,"data-svelte-h":!0}),V(i)!=="svelte-hluucs"&&(i.textContent=o),c=M(_),l=E(_,"TEXTAREA",{class:!0,rows:!0}),I(l).forEach(k),h=M(_),f=E(_,"DIV",{class:!0});var v=I(f);y=E(v,"BUTTON",{class:!0,"data-svelte-h":!0}),V(y)!=="svelte-1admezx"&&(y.textContent=d),p=M(v),b=E(v,"BUTTON",{class:!0});var x=I(b);P=G(x,"Next"),x.forEach(k),v.forEach(k),_.forEach(k),m.forEach(k),this.h()},h(){S(n,"class","font-light"),S(i,"class","text-fidelity-neutral-500 my-3"),S(l,"class","single svelte-x99d95"),S(l,"rows","1"),S(y,"class","back"),S(b,"class","next"),b.disabled=r[5],S(f,"class","grid grid-cols-2 w-3/4 mx-auto pt-8 gap-4"),S(t,"class","w-96 h-1/2 mx-auto text-center"),S(e,"class","h-[calc(100vh-112px)] pt-[10vh]")},m(w,m){j(w,e,m),g(e,t),g(t,n),g(t,a),g(t,i),g(t,c),g(t,l),r[7](l),we(l,r[3].password),g(t,h),g(t,f),g(f,y),g(f,p),g(f,b),g(b,P),R||(u=[B(l,"input",r[8]),B(l,"keydown",r[9]),B(y,"click",r[10]),B(b,"click",r[11])],R=!0)},p(w,[m]){m&8&&we(l,w[3].password),m&32&&(b.disabled=w[5])},i:q,o:q,d(w){w&&k(e),r[7](null),R=!1,Ee(u)}}}function Ea(r,e,t){let n,s;_e(r,J,b=>t(3,s=b));let{back:a=""}=e,{next:i=""}=e,{changeStep:o=b=>{}}=e,c;xe(()=>{Se.set(!0),c==null||c.focus(),window.scrollTo(0,0)});const l=b=>{b.key==="Enter"&&(b.preventDefault(),o(i))};function h(b){We[b?"unshift":"push"](()=>{c=b,t(4,c)})}function f(){s.password=this.value,J.set(s)}const y=b=>l(b),d=()=>o(a),p=()=>o(i);return r.$$set=b=>{"back"in b&&t(0,a=b.back),"next"in b&&t(1,i=b.next),"changeStep"in b&&t(2,o=b.changeStep)},r.$$.update=()=>{r.$$.dirty&8&&t(5,n=s.password?s.password.length<=4:!0)},[a,i,o,s,c,n,l,h,f,y,d,p]}class Ra extends ie{constructor(e){super(),oe(this,e,Ea,Aa,ae,{back:0,next:1,changeStep:2})}}function ws(r,e,t){const n=r.slice();return n[17]=e[t],n[19]=t,n}function bs(r){let e,t=ee(r[5]),n=[];for(let s=0;s<t.length;s+=1)n[s]=ys(ws(r,t,s));return{c(){e=A("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=E(s,"DIV",{class:!0});var a=I(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(k),this.h()},h(){S(e,"class","absolute top-[68px] w-full border-[1px] bg-white text-sm text-fidelity-neutral-600")},m(s,a){j(s,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,a){if(a&352){t=ee(s[5]);let i;for(i=0;i<t.length;i+=1){const o=ws(s,t,i);n[i]?n[i].p(o,a):(n[i]=ys(o),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&k(e),Fe(n,s)}}}function ys(r){let e,t=r[17]+"",n,s,a,i;function o(){return r[13](r[19])}return{c(){e=A("button"),n=z(t),s=O(),this.h()},l(c){e=E(c,"BUTTON",{class:!0,style:!0});var l=I(e);n=G(l,t),s=M(l),l.forEach(k),this.h()},h(){S(e,"class","w-full text-left p-2 border-fidelity-neutral-200 cursor-pointer rounded-none hover:bg-fidelity-neutral-200"),Tt(e,"background-color",r[6]===r[19]?"rgb(230 228 225)":"")},m(c,l){j(c,e,l),g(e,n),g(e,s),a||(i=B(e,"click",o),a=!0)},p(c,l){r=c,l&32&&t!==(t=r[17]+"")&&Ae(n,t),l&64&&Tt(e,"background-color",r[6]===r[19]?"rgb(230 228 225)":"")},d(c){c&&k(e),a=!1,i()}}}function Pa(r){let e,t,n,s="What's your Address?",a,i,o="This will help us give you personalized tax and financial guidance",c,l,h,f,y,d,p,b="Back",P,R,u,w,m,_=r[5].length>0&&bs(r);return{c(){e=A("div"),t=A("div"),n=A("h1"),n.textContent=s,a=O(),i=A("p"),i.textContent=o,c=O(),l=A("div"),h=A("textarea"),f=O(),_&&_.c(),y=O(),d=A("div"),p=A("button"),p.textContent=b,P=O(),R=A("button"),u=z("Next"),this.h()},l(v){e=E(v,"DIV",{class:!0});var x=I(e);t=E(x,"DIV",{class:!0});var C=I(t);n=E(C,"H1",{class:!0,"data-svelte-h":!0}),V(n)!=="svelte-23if35"&&(n.textContent=s),a=M(C),i=E(C,"P",{class:!0,"data-svelte-h":!0}),V(i)!=="svelte-1hhgmn0"&&(i.textContent=o),c=M(C),l=E(C,"DIV",{class:!0});var T=I(l);h=E(T,"TEXTAREA",{class:!0,rows:!0}),I(h).forEach(k),f=M(T),_&&_.l(T),T.forEach(k),y=M(C),d=E(C,"DIV",{class:!0});var W=I(d);p=E(W,"BUTTON",{class:!0,"data-svelte-h":!0}),V(p)!=="svelte-1admezx"&&(p.textContent=b),P=M(W),R=E(W,"BUTTON",{class:!0});var L=I(R);u=G(L,"Next"),L.forEach(k),W.forEach(k),C.forEach(k),x.forEach(k),this.h()},h(){S(n,"class","font-light"),S(i,"class","text-fidelity-neutral-500 my-3"),S(h,"class"," svelte-nz8rex"),S(h,"rows","1"),S(l,"class","relative"),S(p,"class","back"),S(R,"class","next"),R.disabled=r[7],S(d,"class","grid grid-cols-2 w-3/4 mx-auto pt-8 gap-4"),S(t,"class","w-96 h-1/2 mx-auto"),S(e,"class","h-[calc(100vh-112px)] pt-[10vh]")},m(v,x){j(v,e,x),g(e,t),g(t,n),g(t,a),g(t,i),g(t,c),g(t,l),g(l,h),r[10](h),we(h,r[3].address),g(l,f),_&&_.m(l,null),g(t,y),g(t,d),g(d,p),g(d,P),g(d,R),g(R,u),w||(m=[B(h,"input",r[11]),B(h,"keyup",r[12]),B(h,"keydown",Ta),B(p,"click",r[14]),B(R,"click",r[15])],w=!0)},p(v,[x]){x&8&&we(h,v[3].address),v[5].length>0?_?_.p(v,x):(_=bs(v),_.c(),_.m(l,null)):_&&(_.d(1),_=null),x&128&&(R.disabled=v[7])},i:q,o:q,d(v){v&&k(e),r[10](null),_&&_.d(),w=!1,Ee(m)}}}const Ia="fc57a396dfef452cb85db04e17831c49",Ta=r=>r.key==="Enter"&&r.preventDefault();function Fa(r,e,t){let n,s;_e(r,J,m=>t(3,s=m));let a,{back:i}=e,{next:o}=e,{changeStep:c=m=>{}}=e,l=new AbortController;xe(()=>{Se.set(!0),a.focus(),window.scrollTo(0,0)});let h=[],f=0;const y=m=>{t(4,a.value=h[m],a),J.set({...s,address:h[m]}),t(5,h=[]),a.focus()},d=m=>{const _=a.value.trim(),v=`https://api.geoapify.com/v1/geocode/autocomplete?text=${encodeURIComponent(_+" USA")}&lang=en&limit=5&format=json&apiKey=${Ia}`;if(m.key==="Enter"&&h.length>0){t(4,a.value=h[f],a),J.set({...s,address:h[f]}),t(5,h=[]),a.focus();return}if(m.key==="Enter"&&c(o),m.key==="ArrowDown"){t(6,f=f===h.length-1?0:f+1);return}if(m.key==="ArrowUp"){t(6,f=f===0?h.length-1:f-1);return}_.length>5?(l.abort(),l=new AbortController,fetch(v,{signal:l.signal}).then(x=>{if(!x.ok)throw new Error("Network response was not ok");return x.json()}).then(x=>{t(5,h=x.results.map(C=>C.formatted.replace(", United States of America","")))}).catch(x=>{x.name!=="AbortError"&&console.error("Fetch error:",x)})):t(5,h=[])};function p(m){We[m?"unshift":"push"](()=>{a=m,t(4,a)})}function b(){s.address=this.value,J.set(s)}const P=m=>d(m),R=m=>y(m),u=()=>c(i),w=()=>c(o);return r.$$set=m=>{"back"in m&&t(0,i=m.back),"next"in m&&t(1,o=m.next),"changeStep"in m&&t(2,c=m.changeStep)},r.$$.update=()=>{r.$$.dirty&8&&t(7,n=!s.address||s.address.length<=20)},[i,o,c,s,a,h,f,n,y,d,p,b,P,R,u,w]}class Oa extends ie{constructor(e){super(),oe(this,e,Fa,Pa,ae,{back:0,next:1,changeStep:2})}}function vs(r,e,t){const n=r.slice();return n[3]=e[t],n}function Ma(r){let e,t;return{c(){e=A("div"),t=A("div"),this.h()},l(n){e=E(n,"DIV",{class:!0});var s=I(e);t=E(s,"DIV",{class:!0,style:!0}),I(t).forEach(k),s.forEach(k),this.h()},h(){S(t,"class","h-full rounded-l-lg rounded-r-lg bg-fidelity-green-600"),Tt(t,"width",r[1]+"px"),S(e,"class","mt-6 h-8 w-[500px] rounded-lg border-[1px] bg-white mx-auto")},m(n,s){j(n,e,s),g(e,t)},p(n,s){s&2&&Tt(t,"width",n[1]+"px")},d(n){n&&k(e)}}}function Da(r){let e,t=ee(r[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Ss(vs(r,t,s));return{c(){e=A("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=E(s,"DIV",{class:!0});var a=I(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(k),this.h()},h(){S(e,"class","mt-6 grid w-full grid-cols-3 gap-6")},m(s,a){j(s,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,a){if(a&1){t=ee(s[0]);let i;for(i=0;i<t.length;i+=1){const o=vs(s,t,i);n[i]?n[i].p(o,a):(n[i]=Ss(o),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&k(e),Fe(n,s)}}}function Ss(r){let e,t,n=r[3].name+"",s,a,i,o=r[3].rationale+"",c,l,h,f='<button class="bg-fidelity-green-600 text-white">Get Started</button>',y;return{c(){e=A("div"),t=A("div"),s=z(n),a=O(),i=A("div"),c=z(o),l=O(),h=A("div"),h.innerHTML=f,y=O(),this.h()},l(d){e=E(d,"DIV",{class:!0});var p=I(e);t=E(p,"DIV",{class:!0});var b=I(t);s=G(b,n),b.forEach(k),a=M(p),i=E(p,"DIV",{class:!0});var P=I(i);c=G(P,o),P.forEach(k),l=M(p),h=E(p,"DIV",{class:!0,"data-svelte-h":!0}),V(h)!=="svelte-1o6c58z"&&(h.innerHTML=f),y=M(p),p.forEach(k),this.h()},h(){S(t,"class","flex min-h-16 w-full items-center justify-center rounded-t-lg bg-fidelity-green-600 p-2 text-center text-white"),S(i,"class","h-64 w-full overflow-clip p-4 text-sm text-fidelity-neutral-600"),S(h,"class","flex justify-center p-4"),S(e,"class","w-full rounded-lg shadow-md")},m(d,p){j(d,e,p),g(e,t),g(t,s),g(e,a),g(e,i),g(i,c),g(e,l),g(e,h),g(e,y)},p(d,p){p&1&&n!==(n=d[3].name+"")&&Ae(s,n),p&1&&o!==(o=d[3].rationale+"")&&Ae(c,o)},d(d){d&&k(e)}}}function Na(r){let e,t,n="Your Recommendations",s,a,i="Based on our conversation, these are the accounts we recommend",o;function c(f,y){return f[0].length>0?Da:Ma}let l=c(r),h=l(r);return{c(){e=A("div"),t=A("h1"),t.textContent=n,s=O(),a=A("p"),a.textContent=i,o=O(),h.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var y=I(e);t=E(y,"H1",{class:!0,"data-svelte-h":!0}),V(t)!=="svelte-1uhmn4w"&&(t.textContent=n),s=M(y),a=E(y,"P",{class:!0,"data-svelte-h":!0}),V(a)!=="svelte-1cmmurr"&&(a.textContent=i),o=M(y),h.l(y),y.forEach(k),this.h()},h(){S(t,"class",""),S(a,"class","pt-4"),S(e,"class","mx-auto max-w-3xl py-8 text-center")},m(f,y){j(f,e,y),g(e,t),g(e,s),g(e,a),g(e,o),h.m(e,null)},p(f,[y]){l===(l=c(f))&&h?h.p(f,y):(h.d(1),h=l(f),h&&(h.c(),h.m(e,null)))},i:q,o:q,d(f){f&&k(e),h.d()}}}function Ba(r,e,t){let n;_e(r,J,i=>t(2,n=i));let s=[],a=0;return xe(async()=>{console.log("Getting ready to summarize the following data.... ",n);const i=_a();let o=setInterval(()=>{t(1,a+=1),a===500&&(clearInterval(o),(async()=>{try{const c=await i;t(0,s=c.recommendations)}catch(c){console.error("Error fetching data:",c)}})())},20)}),[s,a]}class ja extends ie{constructor(e){super(),oe(this,e,Ba,Na,ae,{})}}function xs(r,e,t){const n=r.slice();return n[7]=e[t],n[9]=t,n}function Cs(r){let e,t=ee(r[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=ks(xs(r,t,s));return{c(){e=A("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=E(s,"DIV",{class:!0});var a=I(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(k),this.h()},h(){S(e,"class","mx-auto flex h-24 flex-row items-center justify-center gap-3")},m(s,a){j(s,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,a){if(a&23){t=ee(s[0]);let i;for(i=0;i<t.length;i+=1){const o=xs(s,t,i);n[i]?n[i].p(o,a):(n[i]=ks(o),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&k(e),Fe(n,s)}}}function ks(r){let e,t=r[9]+1+"",n,s,a,i,o;function c(){return r[6](r[9])}return{c(){e=A("button"),n=z(t),s=O(),this.h()},l(l){e=E(l,"BUTTON",{class:!0});var h=I(e);n=G(h,t),s=M(h),h.forEach(k),this.h()},h(){S(e,"class",a="circle "+(r[9]===r[1]?"current":r[9]<=r[2]?"last":"future")+" svelte-3sjztk")},m(l,h){j(l,e,h),g(e,n),g(e,s),i||(o=B(e,"click",c),i=!0)},p(l,h){r=l,h&6&&a!==(a="circle "+(r[9]===r[1]?"current":r[9]<=r[2]?"last":"future")+" svelte-3sjztk")&&S(e,"class",a)},d(l){l&&k(e),i=!1,o()}}}function La(r){let e,t=r[3]&&Cs(r);return{c(){t&&t.c(),e=Ue()},l(n){t&&t.l(n),e=Ue()},m(n,s){t&&t.m(n,s),j(n,e,s)},p(n,[s]){n[3]?t?t.p(n,s):(t=Cs(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:q,o:q,d(n){n&&k(e),t&&t.d(n)}}}function Va(r,e,t){let n;_e(r,Se,h=>t(3,n=h));let{steps:s=[]}=e,{displayedStep:a=-1}=e,{maxStep:i=0}=e,{changeStep:o=h=>{}}=e;const c=h=>{h>i||h===a||o(h)},l=h=>c(h);return r.$$set=h=>{"steps"in h&&t(0,s=h.steps),"displayedStep"in h&&t(1,a=h.displayedStep),"maxStep"in h&&t(2,i=h.maxStep),"changeStep"in h&&t(5,o=h.changeStep)},[s,a,i,n,c,o,l]}class Wa extends ie{constructor(e){super(),oe(this,e,Va,La,ae,{steps:0,displayedStep:1,maxStep:2,changeStep:5})}}function As(r,e,t){const n=r.slice();return n[10]=e[t],n[12]=t,n}function Es(r){let e,t=r[10].label+"",n,s,a,i;function o(){return r[7](r[12])}return{c(){e=A("button"),n=z(t),s=O(),this.h()},l(c){e=E(c,"BUTTON",{class:!0});var l=I(e);n=G(l,t),s=M(l),l.forEach(k),this.h()},h(){S(e,"class","grid"),It(e,"selected",r[10].status)},m(c,l){j(c,e,l),g(e,n),g(e,s),a||(i=B(e,"click",o),a=!0)},p(c,l){r=c,l&8&&t!==(t=r[10].label+"")&&Ae(n,t),l&8&&It(e,"selected",r[10].status)},d(c){c&&k(e),a=!1,i()}}}function Ua(r){let e,t,n,s="Investments",a,i,o="Tell me what investments you currently have",c,l,h,f,y,d="Back",p,b,P,R,u,w=ee(r[3]),m=[];for(let _=0;_<w.length;_+=1)m[_]=Es(As(r,w,_));return{c(){e=A("div"),t=A("div"),n=A("h1"),n.textContent=s,a=O(),i=A("p"),i.textContent=o,c=O(),l=A("div");for(let _=0;_<m.length;_+=1)m[_].c();h=O(),f=A("div"),y=A("button"),y.textContent=d,p=O(),b=A("button"),P=z("Next"),this.h()},l(_){e=E(_,"DIV",{class:!0});var v=I(e);t=E(v,"DIV",{class:!0});var x=I(t);n=E(x,"H1",{class:!0,"data-svelte-h":!0}),V(n)!=="svelte-udh2j9"&&(n.textContent=s),a=M(x),i=E(x,"P",{class:!0,"data-svelte-h":!0}),V(i)!=="svelte-1t4kldk"&&(i.textContent=o),c=M(x),l=E(x,"DIV",{class:!0});var C=I(l);for(let L=0;L<m.length;L+=1)m[L].l(C);C.forEach(k),h=M(x),f=E(x,"DIV",{class:!0});var T=I(f);y=E(T,"BUTTON",{class:!0,"data-svelte-h":!0}),V(y)!=="svelte-1admezx"&&(y.textContent=d),p=M(T),b=E(T,"BUTTON",{class:!0});var W=I(b);P=G(W,"Next"),W.forEach(k),T.forEach(k),x.forEach(k),v.forEach(k),this.h()},h(){S(n,"class","font-light"),S(i,"class","text-fidelity-neutral-500 my-8"),S(l,"class","flex justify-center items-center flex-wrap gap-4"),S(y,"class","back"),S(b,"class","next"),b.disabled=r[4],S(f,"class","grid grid-cols-2 w-3/4 mx-auto pt-8 gap-4"),S(t,"class","w-96 h-1/2 mx-auto text-center"),S(e,"class","h-[calc(100vh-112px)] pt-[5vh]")},m(_,v){j(_,e,v),g(e,t),g(t,n),g(t,a),g(t,i),g(t,c),g(t,l);for(let x=0;x<m.length;x+=1)m[x]&&m[x].m(l,null);g(t,h),g(t,f),g(f,y),g(f,p),g(f,b),g(b,P),R||(u=[B(y,"click",r[8]),B(b,"click",r[9])],R=!0)},p(_,[v]){if(v&40){w=ee(_[3]);let x;for(x=0;x<w.length;x+=1){const C=As(_,w,x);m[x]?m[x].p(C,v):(m[x]=Es(C),m[x].c(),m[x].m(l,null))}for(;x<m.length;x+=1)m[x].d(1);m.length=w.length}v&16&&(b.disabled=_[4])},i:q,o:q,d(_){_&&k(e),Fe(m,_),R=!1,Ee(u)}}}function qa(r,e,t){let n,s;_e(r,J,d=>t(6,s=d));let{back:a}=e,{next:i}=e,{changeStep:o=d=>{}}=e,c=[{label:"401k",status:0},{label:"Traditional / Roth IRA",status:0},{label:"Crypto Currency",status:0},{label:"Stocks",status:0},{label:"Bonds",status:0},{label:"Mortgage",status:0}].map(d=>({label:d.label,status:s.investments&&s.investments.includes(d.label)?1:0}));xe(()=>{Se.set(!0),window.scrollTo(0,0)});const l=d=>{t(3,c=c.map((p,b)=>d===b?{...p,status:p.status?0:1}:p)),J.update(p=>(p.investments=c.filter(b=>b.status).map(b=>b.label),p))},h=d=>l(d),f=()=>o(a),y=()=>o(i);return r.$$set=d=>{"back"in d&&t(0,a=d.back),"next"in d&&t(1,i=d.next),"changeStep"in d&&t(2,o=d.changeStep)},r.$$.update=()=>{r.$$.dirty&64&&t(4,n=!s.investments||s.investments.length===0)},[a,i,o,c,n,l,s,h,f,y]}class Ha extends ie{constructor(e){super(),oe(this,e,qa,Ua,ae,{back:0,next:1,changeStep:2})}}function Rs(r,e,t){const n=r.slice();return n[6]=e[t],n[8]=t,n}function Ps(r){let e,t,n,s,a,i;var o=r[4][r[8]];function c(l,h){return{props:{back:l[8]-1,next:l[8]+1,changeStep:l[5]}}}return o&&(t=zn(o,c(r))),{c(){e=A("div"),t&&nt(t.$$.fragment),n=O(),this.h()},l(l){e=E(l,"DIV",{class:!0});var h=I(e);t&&ln(t.$$.fragment,h),n=M(h),h.forEach(k),this.h()},h(){S(e,"class","h-full w-full")},m(l,h){j(l,e,h),t&&st(t,e,null),g(e,n),i=!0},p(l,h){if(o!==(o=l[4][l[8]])){if(t){lt();const f=t;$(f.$$.fragment,1,0,()=>{rt(f,1)}),ct()}o?(t=zn(o,c(l)),nt(t.$$.fragment),Y(t.$$.fragment,1),st(t,e,n)):t=null}},i(l){i||(t&&Y(t.$$.fragment,l),l&&Ts(()=>{i&&(a&&a.end(1),s=Fs(e,Ft,{duration:300}),s.start())}),i=!0)},o(l){t&&$(t.$$.fragment,l),s&&s.invalidate(),l&&(a=Os(e,Ft,{duration:300})),i=!1},d(l){l&&k(e),t&&rt(t),l&&a&&a.end()}}}function Is(r){let e,t,n=r[8]===r[1]&&Ps(r);return{c(){n&&n.c(),e=Ue()},l(s){n&&n.l(s),e=Ue()},m(s,a){n&&n.m(s,a),j(s,e,a),t=!0},p(s,a){s[8]===s[1]?n?(n.p(s,a),a&2&&Y(n,1)):(n=Ps(s),n.c(),Y(n,1),n.m(e.parentNode,e)):n&&(lt(),$(n,1,1,()=>{n=null}),ct())},i(s){t||(Y(n),t=!0)},o(s){$(n),t=!1},d(s){s&&k(e),n&&n.d(s)}}}function Xa(r){let e,t,n,s;t=new Wa({props:{steps:r[3],displayedStep:r[2],maxStep:r[0],changeStep:r[5]}});let a=ee(r[3]),i=[];for(let c=0;c<a.length;c+=1)i[c]=Is(Rs(r,a,c));const o=c=>$(i[c],1,1,()=>{i[c]=null});return{c(){e=A("div"),nt(t.$$.fragment),n=O();for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=E(c,"DIV",{class:!0});var l=I(e);ln(t.$$.fragment,l),n=M(l);for(let h=0;h<i.length;h+=1)i[h].l(l);l.forEach(k),this.h()},h(){S(e,"class","w-full bg-fidelity-neutral-50")},m(c,l){j(c,e,l),st(t,e,null),g(e,n);for(let h=0;h<i.length;h+=1)i[h]&&i[h].m(e,null);s=!0},p(c,[l]){const h={};if(l&4&&(h.displayedStep=c[2]),l&1&&(h.maxStep=c[0]),t.$set(h),l&50){a=ee(c[3]);let f;for(f=0;f<a.length;f+=1){const y=Rs(c,a,f);i[f]?(i[f].p(y,l),Y(i[f],1)):(i[f]=Is(y),i[f].c(),Y(i[f],1),i[f].m(e,null))}for(lt(),f=a.length;f<i.length;f+=1)o(f);ct()}},i(c){if(!s){Y(t.$$.fragment,c);for(let l=0;l<a.length;l+=1)Y(i[l]);s=!0}},o(c){$(t.$$.fragment,c),i=i.filter(Boolean);for(let l=0;l<i.length;l+=1)$(i[l]);s=!1},d(c){c&&k(e),rt(t),Fe(i,c)}}}function Ja(r,e,t){const n=["Intro","Goals","Name","Email","Password","Address","Investments","Chat","Summary"],s=[Pr,Fr,jr,ka,Ra,Oa,Ha,Sa,ja];let a=0,i=0,o=0;async function c(l){t(1,i=-1),await _r(),setTimeout(()=>{t(1,i=l),t(2,o=l),l>=a&&t(0,a=l)},300)}return[a,i,o,n,s,c]}class oi extends ie{constructor(e){super(),oe(this,e,Ja,Xa,ae,{})}}export{oi as component};
